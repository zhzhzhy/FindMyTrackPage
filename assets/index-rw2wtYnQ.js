import{$ as de,o as $,c as N,g as t,k as s,a,d as we,W as g,e as W,w as Q,j as B,b as ee,y as T,F as q,r as ce,a0 as ue,a1 as pe,a2 as xe,C as ie,l as Y,m as De,J as ke,v as ne,_ as Ce}from"./vue-vrn0zMNo.js";import{H as Se}from"./@vuepic-CJcSshu8.js";import{u as Z,a as b,r as te,d as O,c as _e}from"./@vue-CojEnYtN.js";import{m as F}from"./mapbox-gl-DWMaBres.js";import{M as $e}from"./@mapbox-xjKLDsbk.js";import"./tinycolor2-CfovpC5H.js";import{P as ye}from"./vue3-emoji-picker-BI_Z11BT.js";import{e as re}from"./gcoord-CaovwXKb.js";import{c as Le,a as Ve}from"./vue-router-h5yuP0F9.js";import{i as Me,z as je}from"./element-plus-17KCLzoK.js";import"./vue3-openlayers-DEL4v-Rs.js";import{Q as Pe}from"./@element-plus-Qx67WbJO.js";import{l as Ie,f as Ne,F as Te}from"./@fortawesome-DNkv1NAJ.js";import"./date-fns-DjqgiLk-.js";import"./lodash-es-CiJSjksT.js";import"./@vueuse-CZ3kz2oL.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-n4Xreh4I.js";import"./async-validator-CiEh-HP4.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-B-WCBpf0.js";import"./ol-PaOofTtg.js";import"./rbush-DoHIURGA.js";import"./quickselect-cI_fw6Fh.js";import"./color-space-CC1atxIw.js";import"./color-rgba-QbDrIVEx.js";import"./color-parse-D1WSI7GZ.js";import"./color-name-XvCybByO.js";import"./earcut-DymNFgKl.js";import"./ol-ext-DKhM1omF.js";import"./ol-contextmenu-DtPVqisZ.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))e(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&e(i)}).observe(document,{childList:!0,subtree:!0});function p(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function e(o){if(o.ep)return;o.ep=!0;const l=p(o);fetch(o.href,l)}})();const R=(r,n)=>{const p=r.__vccOpts||r;for(const[e,o]of n)p[e]=o;return p},He={class:"daterangepicker"},Oe={class:"sidebar"},Ee={__name:"VueDatePicker",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(r){const n=de(r,"modelValue");if(!n.value||n.value.length===0){const l=new Date,i=new Date(new Date().setDate(l.getDate()-7));n.value=[i,l]}const p=()=>{const l=new Date,i=new Date(new Date().setHours(l.getHours()-1));n.value=[i,l]},e=()=>{const l=new Date,i=new Date(new Date().setDate(l.getDate()-1));n.value=[i,l]},o=()=>{const l=new Date,i=new Date(new Date().setDate(l.getDate()-7));n.value=[i,l]};return(l,i)=>($(),N("div",He,[t(Z(Se),{modelValue:n.value,"onUpdate:modelValue":i[3]||(i[3]=c=>n.value=c),teleport:!0,range:""},{"right-sidebar":s(()=>[a("div",Oe,[a("div",{class:"sidebar-div",onClick:i[0]||(i[0]=c=>p())},"Last Hour"),a("div",{class:"sidebar-div",onClick:i[1]||(i[1]=c=>e())},"Last Day"),a("div",{class:"sidebar-div",onClick:i[2]||(i[2]=c=>o())},"Last Week")])]),_:1},8,["modelValue"])]))}},ve=R(Ee,[["__scopeId","data-v-02a0f943"]]),Fe={class:"block"},ze=we({__name:"ElementDateTimePicker",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(r){const n=de(r,"modelValue");if(!n.value||n.value.length===0){const e=new Date,o=new Date(new Date().setDate(e.getDate()-7));n.value=[o,e]}const p=[{text:"Last day",value:()=>{const e=new Date,o=new Date;return o.setDate(o.getDate()-1),[o,e]}},{text:"Last week",value:()=>{const e=new Date,o=new Date;return o.setDate(o.getDate()-7),[o,e]}},{text:"Last month",value:()=>{const e=new Date,o=new Date;return o.setMonth(o.getMonth()-1),[o,e]}},{text:"Last 3 months",value:()=>{const e=new Date,o=new Date;return o.setMonth(o.getMonth()-3),[o,e]}}];return(e,o)=>{const l=g("el-date-picker");return $(),N("div",Fe,[t(l,{modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=i=>n.value=i),type:"datetimerange",shortcuts:p,"range-separator":"To","start-placeholder":"Start date","end-placeholder":"End date"},null,8,["modelValue"])])}}}),Re=R(ze,[["__scopeId","data-v-aadf7784"]]),Ue={__name:"GeoJSONConverter",props:{data:{type:Object,required:!0,default:{}}},setup(r,{expose:n}){const p=r,e=b({}),o=l=>{if(Object.keys(l).length>0){const i=l.data,c=[...i].sort((w,I)=>new Date(w.isodatetime)-new Date(I.isodatetime)),D=c.map(w=>({type:"Feature",properties:{name:w.id_short,id:w.id,conf:w.conf,status:w.status,TimeStamp:w.isodatetime,statusCode:w.statusCode},geometry:{type:"Point",coordinates:[w.longitude,w.latitude]}})),k=new Map,h=new Set([...i].map(w=>w.id));for(const w of h){const I=c.filter(v=>v.id==w).map(v=>[v.longitude,v.latitude]);I.length>1&&k.set(w,I)}const m=Array.from(k,([w,I])=>({type:"Feature",properties:{id:w},geometry:{type:"LineString",coordinates:I,direction:"forward","arrow-symbol":"triangle"}}));e.value={type:"FeatureCollection",features:[...D,...m]}}};return W(()=>{Q(()=>p.data,l=>{Object.keys(l).length>0&&o(l)},{immediate:!0})}),n({convertToGeoJson:o,geoJsonData:e}),(l,i)=>null}},Ae={__name:"DataHandler",props:{payload:{type:Object,default:{}}},setup(r,{expose:n}){const p=b(null),e=b(!0),o=b(null),l=b(),i=b(null),c=async D=>{const k={idArray:D.idSelected,dateTimeRange:{start:D.dateTimeRange[0],end:D.dateTimeRange[1]},mode:D.mode};try{const h=await fetch("https://fmt.geeek.cf/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)});if(!h.ok)throw new Error(`Error: ${h.statusText}`);const m=await h.json();return m&&(l.value=m),m}catch(h){o.value=h.message}finally{e.value=!1}};return W(async()=>{Q(()=>p.value.geoJsonData,D=>{D&&(i.value=p.value.geoJsonData)},{immediate:!0})}),n({fetchData:c,exposedData:i}),(D,k)=>($(),B(Ue,{data:l.value,ref_key:"Geojsondata",ref:p},null,8,["data"]))}},me=R(Ae,[["__scopeId","data-v-91e4577f"]]),he={__name:"localStorage",props:{data:{type:Object,required:!0,default:{}}},setup(r){const p=r.data;return Q(()=>p,e=>{const o=JSON.stringify(e);localStorage.setItem("itemsProp",o)},{deep:!0}),(e,o)=>null}},X=r=>(ue("data-v-8d749dff"),r=r(),pe(),r),Ke={class:"main-layout-wrapper"},Be={class:"main-layout"},Je=X(()=>a("i",{class:"fa-solid fa-list",style:{"margin-right":"10px"}},null,-1)),Ge={class:"flex-center"},qe={class:"flex flex-wrap gap-4"},We=X(()=>a("span",{class:"hide-small",style:{"vertical-align":"middle"}}," Clear ",-1)),Ye={class:"flex"},Ze=X(()=>a("i",{class:"fa-regular fa-square-check hide-small margin-right"},null,-1)),Qe=X(()=>a("i",{class:"fa-solid fa-fire hide-small margin-right"},null,-1)),Xe=X(()=>a("i",{class:"fa-regular fa-clock hide-small margin-right"},null,-1)),et={__name:"MainPanel",props:{itemsProps:{type:Object,default:{}}},emits:["submit","addHeatMap","realtime"],setup(r,{emit:n}){const p=b(!1);b("btt");const e=b([]),o=b({}),l=b(null),i=b({}),c=te({idSelected:[],dateTimeRange:{start:"",end:""},mode:""}),D=r,k=n,h=ee(()=>window.innerWidth<=770?"90%":"30%"),m=()=>{c.idSelected.length>0&&Array.from(c.dateTimeRange).length>1&&k("submit",c)},w=()=>{c.idSelected.length>0&&Array.from(c.dateTimeRange).length>1&&k("addHeatMap",c)},I=()=>{c.idSelected.length>0&&k("realtime",c)},v=()=>{c.idSelected=[]};return W(()=>{c.dateTimeRange=e.value,Q(()=>e.value,x=>{c.dateTimeRange=x,o.value=x}),Q(()=>c,x=>{o.value=x},{deep:!0})}),(x,S)=>{const V=g("el-button"),M=g("el-option"),J=g("el-select"),A=g("el-col"),j=g("CircleClose"),_=g("el-icon"),d=g("el-row"),u=g("el-form-item"),f=g("el-form"),C=g("el-card"),L=g("el-dialog");return $(),N(q,null,[a("div",Ke,[a("div",Be,[t(ve,{modelValue:e.value,"onUpdate:modelValue":S[0]||(S[0]=y=>e.value=y),range:"",class:"VueDatePicker"},null,8,["modelValue"])]),t(V,{class:"dialog-button",type:"primary",onClick:S[1]||(S[1]=y=>p.value=!0)},{default:s(()=>[Je,T("Data Select ")]),_:1}),t(me,{payload:o.value,ref_key:"DataHandlerRef",ref:l},null,8,["payload"]),t(he,{data:i.value},null,8,["data"])]),t(L,{modelValue:p.value,"onUpdate:modelValue":S[5]||(S[5]=y=>p.value=y),title:"Data select",width:h.value,draggable:"","align-center":""},{default:s(()=>[a("div",Ge,[a("div",qe,[t(C,{class:"card",shadow:"never",style:{"max-width":"600px"}},{default:s(()=>[t(f,{model:c,"label-width":"auto"},{default:s(()=>[t(u,{label:"Items select"},{default:s(()=>[t(d,{gutter:10},{default:s(()=>[t(A,{span:20},{default:s(()=>[t(J,{modelValue:c.idSelected,"onUpdate:modelValue":S[2]||(S[2]=y=>c.idSelected=y),multiple:"",filterable:"","default-first-option":"","reserve-keyword":!1,placeholder:"Choose your items",style:{"min-width":"150px"}},{default:s(()=>[($(!0),N(q,null,ce(D.itemsProps.value,(y,H)=>($(),B(M,{key:H,label:`${y.emoji} ${y.Name}`,value:y.pubKey},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(A,{span:4},{default:s(()=>[t(V,{onClick:v,type:"primary"},{default:s(()=>[t(_,{style:{"vertical-align":"middle"}},{default:s(()=>[t(j)]),_:1}),We]),_:1})]),_:1})]),_:1})]),_:1}),t(u,{label:"Activity time",style:{"max-width":"600px"}},{default:s(()=>[t(A,{span:24},{default:s(()=>[t(Re,{class:"responsive-component",modelValue:e.value,"onUpdate:modelValue":S[3]||(S[3]=y=>e.value=y)},null,8,["modelValue"]),t(ve,{class:"responsive-component-display",modelValue:e.value,"onUpdate:modelValue":S[4]||(S[4]=y=>e.value=y),range:""},null,8,["modelValue"])]),_:1})]),_:1}),t(u,null,{default:s(()=>[a("div",Ye,[t(V,{type:"primary",onClick:m},{default:s(()=>[Ze,T("Get Data ")]),_:1}),t(V,{type:"primary",onClick:w},{default:s(()=>[Qe,T("HeatMap ")]),_:1}),t(V,{type:"primary",onClick:I},{default:s(()=>[Xe,T("RealTime ")]),_:1})])]),_:1})]),_:1},8,["model"])]),_:1})])])]),_:1},8,["modelValue","width"])],64)}}},tt=R(et,[["__scopeId","data-v-8d749dff"]]),ot={id:"menu"},at={class:"input-label-row"},lt=["id","value","checked"],st=["for"],ge="streets",nt={__name:"MapboxMain",props:{geodata:{type:Object,default:{}},itemsPropMap:{type:Object,default:{}}},setup(r,{expose:n}){const p=b(null),e=b(null),o=b(null);let l=!1;const i={ar:"ar",de:"de",en:"en",es:"es",fr:"fr",it:"it",ja:"ja",ko:"ko",mul:"mul",pt:"pt",ru:"ru",vi:"vi","zh-CN":"zh-Hans","zh-HK":"zh-Hant","zh-TW":"zh-Hant","zh-Hans":"zh-Hans","zh-Hant":"zh-Hant"},c=[],D="pk.eyJ1IjoiZ2Vla2NhdCIsImEiOiJjbHc5ZTJ6dmIwMTEyMmpudGowMXk5Y3o2In0.HDxYFBSNCpbYan731GLJEw",k=[{id:"satellite-streets",label:"Satellite Streets",url:"mapbox://styles/geekcat/clwc44om0008b01pn91yg82cg"},{id:"light-v11",label:"Light",url:"mapbox://styles/mapbox/light-v11"},{id:"dark-v11",label:"Dark",url:"mapbox://styles/mapbox/dark-v11"},{id:"streets",label:"Streets",url:"mapbox://styles/geekcat/clwxb0z8q01ep01pohp1h4q4d"},{id:"outdoors",label:"Outdoors",url:"mapbox://styles/geekcat/clwxbnita01es01po7fto915q"},{id:"amap",label:"È´òÂæ∑Âú∞Âõæ",url:{version:8,sources:{"raster-tiles":{type:"raster",tiles:["https://wprd04.is.autonavi.com/appmaptile?lang=zh_cn&size=1&style=7&x={x}&y={y}&z={z}"],tileSize:256}},layers:[{id:"amap-tiles",type:"raster",source:"raster-tiles",minzoom:0,maxzoom:24}]}}],h=r,m=()=>{const d=navigator.language||navigator.userLanguage,u=navigator.language.split("-")[0];let f="mul";u=="zh"&&i[d]&&(f=i[d]),u!=="zh"&&i[u]&&(f=i[u]),F.setRTLTextPlugin("https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js");const C=new $e({defaultLanguage:f});e.value.language=f,e.value.setStyle(C.setLanguage(e.value.getStyle(),f)),e.value.addControl(C)},w=d=>{const u=d.target.value,f=k.find(C=>C.id===u).url;e.value&&(e.value.setStyle(f),e.value.once("style.load",()=>{h.geodata.status=="GeoJSONLayers"&&x(h.geodata.data),h.geodata.status=="HeatMap"&&v(h.geodata.data)}))},I=d=>{const u=["match",["get","id"]];return Object.entries(d).length>0&&Object.entries(d).forEach(([C,L])=>{u.push(C,L)}),u.push("#B42222"),u},v=d=>{Object.keys(d).length!=0&&(e.value.getSource("findmy-data")||e.value.addSource("findmy-data",{type:"geojson",data:d}),e.value.getLayer("findmy-heatmap")||e.value.addLayer({id:"findmy-heatmap",type:"heatmap",source:"findmy-data",maxzoom:17,paint:{"heatmap-intensity":["interpolate",["linear"],["zoom"],0,1,9,3,15,10],"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(33,102,172,0)",.2,"rgb(103,169,207)",.4,"rgb(209,229,240)",.6,"rgb(253,219,199)",.8,"rgb(239,138,98)",1,"rgb(178,24,43)"],"heatmap-radius":["interpolate",["linear"],["zoom"],0,2,9,15],"heatmap-opacity":["interpolate",["linear"],["zoom"],0,.6,10,.7,17,1]},filter:["==","$type","Point"]}))},x=d=>{if(Object.keys(d).length==0)return;const u={},f={};Object.entries(h.itemsPropMap.value).forEach(y=>{const[H,E]=y;u[H]=E.pointColor,f[H]=E.lineColor});const C=I(u),L=I(f);e.value.getSource("findmy-data")||e.value.addSource("findmy-data",{type:"geojson",data:d}),e.value.getLayer("findmy-point")||e.value.addLayer({id:"findmy-point",type:"circle",source:"findmy-data",paint:{"circle-radius":6,"circle-color":C},filter:["==","$type","Point"]}),e.value.getLayer("findmy-route")||e.value.addLayer({id:"findmy-route",type:"line",source:"findmy-data",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":L,"line-width":3,"line-dasharray":[1,2]},filter:["==","$type","LineString"]}),e.value.getLayer("line-arrows")||e.value.addLayer({id:"line-arrows",type:"symbol",source:"findmy-data",layout:{"symbol-placement":"line","text-field":"‚ñ∂","text-size":24,"symbol-spacing":50,"text-keep-upright":!1},paint:{"text-color":"red"},filter:["==","$type","LineString"]})},S=(d,u)=>{d.forEach(f=>{e.value.getLayer(f)&&e.value.removeLayer(f)}),u.forEach(f=>{e.value.getSource(f)&&e.value.removeSource(f)})},V=d=>{const u=new F.LngLatBounds;d.features.forEach(function(f){const C=f.geometry.coordinates;u.extend(C)}),e.value.fitBounds(u,{padding:20})},M=d=>{const u=["in",["get","name"],["literal",d]];e.value.setFilter("findmy-point",u),e.value.setFilter("findmy-route",u),e.value.setFilter("line-arrows",u),l=!0},J=()=>{e.value.setFilter("findmy-point",null),e.value.setFilter("findmy-route",null),e.value.setFilter("line-arrows",null),l=!1},A=d=>{for(const u of d.features){const f=u.properties.id,C=document.createElement("div");C.className="marker";const L=document.createElement("div");if(L.className="markerWrapper",L.innerHTML='<div class="emoji-wrapper">üåè</div>',h.itemsPropMap.value[f].emoji){const se=h.itemsPropMap.value[f].emoji;L.innerHTML=`<div class="emoji-wrapper">${se}</div>`}C.appendChild(L);const y=u.properties.name,H=u.geometry.coordinates,E=H.join(","),z=u.properties.TimeStamp,ae=new F.Popup({offset:25}).setHTML(`<strong>Name:</strong> ${y}<br/><strong>Coordinates:</strong> ${E}<br/><strong>Timestamp:</strong> ${z}`),le=new F.Marker(C).setLngLat(H).setPopup(ae).addTo(e.value);c.push(le)}},j=()=>{if(c.length>0)for(const d of c)d.remove()},_=new F.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0});return n({map:e,switchStyle:w,setStyleLanguage:m,geometryColorSet:I,addHeatmapLayer:v,addGeoJSONLayers:x,removeGeoJSONLayers:S,setMapFilter:M,removeMapFilter:J,FitBounds:V,addRealtimeMarker:A,removeMarkers:j}),W(()=>{const d=[104.0657,30.6594];F.accessToken=D,e.value=new F.Map({container:p.value,style:k.find(u=>u.id===ge).url,center:d,zoom:2}),e.value.on("load",()=>{m()}),e.value.on("mouseenter","findmy-point",u=>{e.value.getCanvas().style.cursor="pointer";const f=l?1:0,C=u.features[f].geometry.coordinates.slice(),L=C.map(z=>z.toFixed(4).toString()),y=u.features[f].properties.TimeStamp,H=u.features[f].properties.name,E=new F.Popup({offset:25}).setLngLat(C).setHTML(`<strong>Name:</strong> ${H}<br/><strong>Coordinates:</strong> ${L}<br/><strong>Timestamp:</strong> ${y}`).addTo(e.value);e.value.on("mouseleave","findmy-point",()=>{e.value.getCanvas().style.cursor="",E.remove()})}),e.value.on("click","findmy-point",u=>{const f=l?1:0,C=u.features[f].geometry.coordinates.slice(),L=C.map(E=>E.toFixed(4).toString()),y=u.features[f].properties.TimeStamp,H=u.features[f].properties.name;new F.Popup({offset:25}).setLngLat(C).setHTML(`<strong>Name:</strong> ${H}<br/><strong>Coordinates:</strong> ${L}<br/><strong>Timestamp:</strong> ${y}`).addTo(e.value)}),e.value.addControl(new F.NavigationControl),e.value.addControl(_)}),(d,u)=>{const f=g("el-row"),C=g("el-col");return $(),N("div",null,[a("div",{id:"map",ref_key:"mapContainer",ref:p},null,512),t(me,{ref_key:"DataHandlerRef",ref:o},null,512),a("div",ot,[t(C,null,{default:s(()=>[($(),N(q,null,ce(k,L=>t(f,{span:6,key:L.id},{default:s(()=>[a("div",at,[a("input",{id:L.id,type:"radio",name:"rtoggle",value:L.id,checked:L.id===ge,onChange:w},null,40,lt),a("label",{for:L.id},O(L.label),9,st)])]),_:2},1024)),64))]),_:1})])])}}},rt=R(nt,[["__scopeId","data-v-d449718e"]]),fe=r=>(ue("data-v-a0b54543"),r=r(),pe(),r),it={class:"flex-row-center"},dt={class:"flex-row"},ct=fe(()=>a("div",{class:"margin-right"},"iconColor:",-1)),ut={class:"flex-row"},pt=fe(()=>a("div",{class:"margin-right"},"pointColor:",-1)),mt={class:"flex-row"},ft=fe(()=>a("div",{class:"margin-right"},"lineColor:",-1)),vt={__name:"ColorPicker",props:{PropsMap:Object,selectedDevice:Object},setup(r){const n=r,p=ee({get(){return n.selectedDevice.prop.bgColor},set(i){n.selectedDevice.prop.bgColor=i}}),e=ee({get(){return n.selectedDevice.prop.pointColor},set(i){n.selectedDevice.prop.pointColor=i}}),o=ee({get(){return n.selectedDevice.prop.lineColor},set(i){n.selectedDevice.prop.lineColor=i}}),l=b(["#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","rgb(255, 120, 0)","#c71585"]);return(i,c)=>{const D=g("el-color-picker"),k=g("el-col"),h=g("el-row");return $(),N("div",it,[t(h,{gutter:10},{default:s(()=>[t(k,{xs:24,sm:24,md:8,lg:8},{default:s(()=>[a("div",dt,[ct,t(D,{modelValue:p.value,"onUpdate:modelValue":c[0]||(c[0]=m=>p.value=m),predefine:l.value},null,8,["modelValue","predefine"])])]),_:1}),t(k,{xs:24,sm:24,md:8,lg:8},{default:s(()=>[a("div",ut,[pt,t(D,{modelValue:e.value,"onUpdate:modelValue":c[1]||(c[1]=m=>e.value=m),predefine:l.value},null,8,["modelValue","predefine"])])]),_:1}),t(k,{xs:24,sm:24,md:8,lg:8},{default:s(()=>[a("div",mt,[ft,t(D,{modelValue:o.value,"onUpdate:modelValue":c[2]||(c[2]=m=>o.value=m),predefine:l.value},null,8,["modelValue","predefine"])])]),_:1})]),_:1})])}}},gt=R(vt,[["__scopeId","data-v-a0b54543"]]),_t={key:0,class:"flex-column"},yt={class:"justify-center"},ht={class:"Emoji-2x"},bt={class:"Edit-info-div"},wt={class:"Edit-info-div-inner"},xt={class:"info-item flex-prop"},Dt={key:0,class:"single-line-text"},kt={class:"info-item flex-prop"},Ct={key:0,class:"single-line-text"},St={class:"info-item flex-prop"},$t={key:0,class:"single-line-text"},Lt={class:"info-item flex-prop"},Vt={key:0,class:"single-line-text"},Mt={__name:"EditDeviceDialog",props:xe({dialogEditVisible:Boolean,selectedDevice:Object,iconBgColor:Function,onSelectEmoji:Function},{modelValue:{prop:"modelValue",event:"update:modelValue"},modelModifiers:{}}),emits:["update:modelValue"],setup(r){const n=r,p=de(r,"modelValue"),e=b(!1),o=b(!1),l=b(!1),i=b(!1),c=b(!1),D=h=>{if(!c.value)switch(c.value=!0,setTimeout(()=>{c.value=!1},100),h){case"Name":e.value=!e.value;break;case"pubKey":o.value=!o.value;break;case"Location":l.value=!l.value;break;case"Lastupdate":i.value=!i.value;break}},k=h=>{D(h)};return(h,m)=>{const w=g("el-button"),I=g("el-popover"),v=g("el-col"),x=g("el-input"),S=g("el-row"),V=g("el-dialog");return $(),B(V,{modelValue:p.value,"onUpdate:modelValue":m[9]||(m[9]=M=>p.value=M),title:"Edit Device",draggable:"",width:"50%",class:"responsive-dialog"},{default:s(()=>[r.selectedDevice?($(),N("div",_t,[t(S,{gutter:10},{default:s(()=>[t(v,{xs:24,sm:24,md:6,lg:4},{default:s(()=>[a("div",yt,[t(I,{placement:"top",title:"Icon Picker",width:300,trigger:"click"},{reference:s(()=>[t(w,{class:"icon-div-2x",style:_e(r.iconBgColor(r.selectedDevice.prop.bgColor))},{default:s(()=>[a("div",ht,O(r.selectedDevice.prop.emoji),1)]),_:1},8,["style"])]),default:s(()=>[t(Z(ye),{native:!0,onSelect:m[0]||(m[0]=M=>r.onSelectEmoji(M,r.selectedDevice.id))})]),_:1})])]),_:1}),t(v,{xs:24,sm:24,md:18,lg:20},{default:s(()=>[a("div",bt,[a("div",wt,[a("div",xt,[T(" Name: "),e.value?($(),B(x,{key:1,modelValue:r.selectedDevice.prop.Name,"onUpdate:modelValue":m[1]||(m[1]=M=>r.selectedDevice.prop.Name=M),onBlur:m[2]||(m[2]=M=>k("Name")),onKeyup:m[3]||(m[3]=ie(M=>k("Name"),["enter"]))},null,8,["modelValue"])):($(),N("span",Dt,O(r.selectedDevice.prop.Name),1)),a("i",{onClick:m[4]||(m[4]=M=>D("Name")),class:"fas fa-edit edit-icon"})]),a("div",kt,[T(" pubKey: "),o.value?($(),B(x,{key:1,modelValue:r.selectedDevice.prop.pubKey,"onUpdate:modelValue":m[5]||(m[5]=M=>r.selectedDevice.prop.pubKey=M),onBlur:m[6]||(m[6]=M=>k("pubKey")),onKeyup:m[7]||(m[7]=ie(M=>k("pubKey"),["enter"]))},null,8,["modelValue"])):($(),N("span",Ct,O(r.selectedDevice.prop.pubKey),1)),a("i",{onClick:m[8]||(m[8]=M=>D("pubKey")),class:"fas fa-edit edit-icon"})]),a("div",St,[T(" Location: "),l.value?Y("",!0):($(),N("span",$t,O(r.selectedDevice.prop.Location),1))]),a("div",Lt,[T(" Lastupdate: "),i.value?Y("",!0):($(),N("span",Vt,O(r.selectedDevice.prop.Lastupdate),1))])])])]),_:1})]),_:1}),t(gt,De(h.$attrs,{selectedDevice:n.selectedDevice}),null,16,["selectedDevice"])])):Y("",!0)]),_:1},8,["modelValue"])}}},jt=R(Mt,[["__scopeId","data-v-64d6d802"]]),U=r=>(ue("data-v-b1e95d67"),r=r(),pe(),r),Pt={class:"manageForm"},It=U(()=>a("span",{class:"hide-small",style:{"vertical-align":"middle"}}," Add ",-1)),Nt={class:"justify-end"},Tt=U(()=>a("i",{class:"fa-solid fa-trash margin-right"},null,-1)),Ht=U(()=>a("span",{class:"hide-small",style:{"vertical-align":"middle"}}," Clear All",-1)),Ot=U(()=>a("i",{class:"fa-solid fa-rotate-right margin-right"},null,-1)),Et=U(()=>a("span",{class:"hide-small",style:{"vertical-align":"middle"}}," Refresh ",-1)),Ft={class:"scrolldiv"},zt={class:"itemsdiv"},Rt={class:"card-inner"},Ut={class:"Emoji"},At={class:"item-prop"},Kt={class:"flex-prop"},Bt={class:"flex-wrap"},Jt={key:0},Gt=U(()=>a("i",{class:"fa-solid fa-copy"},null,-1)),qt={class:"flex-prop"},Wt={class:"flex-wrap"},Yt={key:0},Zt=U(()=>a("i",{class:"fa-solid fa-copy"},null,-1)),Qt={class:"single-line-text"},Xt={class:"single-line-text"},eo={class:"main-layout-wrapper"},to=U(()=>a("i",{class:"fa-solid fa-box-archive",style:{"margin-right":"10px"}},null,-1)),oo={__name:"itemsManage",props:{propsMap:{type:Object,default:{}}},emits:["updateItemProps","reqUpdateItemProps"],setup(r,{emit:n}){const p=b(!1),e=b(!1),o=b(""),l=b(new Set),i=b(null),c=b(null),D=n,k=_=>_?`background-color:${_}`:"",h=b("350px"),m=()=>{const _=window.innerWidth,d=window.innerHeight;h.value=d*.5+"px",_<=768&&(h.value=d*.6+"px")};W(()=>{m(),window.addEventListener("resize",m),A()}),ke(()=>{window.removeEventListener("resize",m)});const w=_=>{c.value={id:_,prop:j[_]},e.value=!0},I=_=>{i.value=_},v=_=>{_ in j&&delete j[_]},x=(_,d)=>{j[d].emoji=_.i,j[d].emojiName=_.n[0],j[d].emojiValue=_.u},S=()=>{const _=o.value;if(_&&!l.value.has(_)){l.value.add(_);const d=_;j[d]={emoji:"üåè",emojiName:"",emojiValue:"",bgColor:"#FFFFFF",pointColor:"red",lineColor:"blue",Name:_,serialNum:"N/A",pubKey:d,Lastupdate:"N/A",Added:new Date().toISOString(),Coordinate:["N/A","N/A"],Location:"N/A"},D("updateItemProps",j),o.value=""}},V=()=>{D("reqUpdateItemProps",j)},M=()=>{Object.keys(j).forEach(_=>{delete j[_]})},J=_=>{navigator.clipboard.writeText(_).then(()=>{console.log("Copied to clipboard successfully!")},d=>{console.error("Could not copy text: ",d)})},A=()=>{if(localStorage.getItem("itemsProp")){const _=localStorage.getItem("itemsProp"),d=JSON.parse(_);Object.assign(j,d.value),D("updateItemProps",j)}};let j=te({});return(_,d)=>{const u=g("el-input"),f=g("el-col"),C=g("CirclePlus"),L=g("el-icon"),y=g("el-button"),H=g("el-popconfirm"),E=g("el-row"),z=g("el-popover"),ae=g("el-card"),le=g("el-scrollbar"),se=g("el-dialog");return $(),N(q,null,[t(se,{modelValue:p.value,"onUpdate:modelValue":d[1]||(d[1]=P=>p.value=P),title:"Items Manage",draggable:"",width:"95%"},{default:s(()=>[a("div",Pt,[t(E,{gutter:20},{default:s(()=>[t(f,{xs:12,sm:8},{default:s(()=>[t(u,{modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=P=>o.value=P),onKeydown:ie(S,["enter"])},null,8,["modelValue"])]),_:1}),t(f,{xs:4,sm:4},{default:s(()=>[t(y,{type:"primary",onClick:S},{default:s(()=>[t(L,{style:{"vertical-align":"middle"}},{default:s(()=>[t(C)]),_:1}),It]),_:1})]),_:1}),t(f,{xs:4,sm:8}),t(f,{xs:4,sm:4},{default:s(()=>[a("div",Nt,[t(H,{"confirm-button-text":"Yes","cancel-button-text":"No","icon-color":"red",title:"Are you sure to delete All items?",onConfirm:M},{reference:s(()=>[t(y,{class:"clear-button",type:"danger"},{default:s(()=>[Tt,Ht]),_:1})]),_:1}),t(y,{class:"refresh-button",type:"primary",onClick:V},{default:s(()=>[Ot,Et]),_:1})])]),_:1})]),_:1})]),t(le,{"max-height":h.value},{default:s(()=>[a("div",Ft,[a("div",zt,[t(E,{gutter:10},{default:s(()=>[($(!0),N(q,null,ce(Z(j),(P,G)=>($(),B(f,{key:G,xs:24,sm:12,md:8,lg:6},{default:s(()=>[t(z,{ref_for:!0,ref:"popover",placement:"top",title:"Options",width:200,trigger:"contextmenu"},{reference:s(()=>[t(ae,{class:"card",shadow:"hover",onClick:K=>w(G)},{default:s(()=>[a("div",Rt,[t(z,{placement:"right",title:"Icon Picker",width:300,trigger:"click"},{reference:s(()=>[t(y,{class:"icon-div",onClick:ne(K=>I(G),["stop"]),style:_e(k(P.bgColor))},{default:s(()=>[a("div",Ut,O(P.emoji),1)]),_:2},1032,["onClick","style"])]),default:s(()=>[t(Z(ye),{native:!0,onSelect:K=>x(K,G)},null,8,["onSelect"])]),_:2},1024),a("div",At,[a("div",Kt,[T("Name: "),t(z,{trigger:"hover",placement:"top"},{reference:s(()=>[a("div",Bt,[T(O(P.Name.substring(0,13))+" ",1),P.Name.length>10?($(),N("div",Jt,"... ")):Y("",!0),t(y,{link:"",onClick:ne(K=>J(P.Name),["stop"])},{default:s(()=>[Gt]),_:2},1032,["onClick"])])]),default:s(()=>[a("div",null,O(P.Name),1)]),_:2},1024)]),a("div",qt,[T("pubKey: "),t(z,{trigger:"hover",placement:"top"},{reference:s(()=>[a("div",Wt,[T(O(P.pubKey.substring(0,13))+" ",1),P.pubKey.length>10?($(),N("div",Yt,"... ")):Y("",!0),t(y,{link:"",onClick:ne(K=>J(P.pubKey),["stop"])},{default:s(()=>[Zt]),_:2},1032,["onClick"])])]),default:s(()=>[a("div",null,O(P.pubKey),1)]),_:2},1024)]),a("div",Qt,"Location: "+O(P.Location),1),a("div",Xt,"LastUpdate: "+O(P.Lastupdate),1)])])]),_:2},1032,["onClick"])]),default:s(()=>[a("div",null,[t(y,{onClick:K=>w(G)},{default:s(()=>[T("Edit")]),_:2},1032,["onClick"]),t(y,{type:"danger",onClick:K=>v(G)},{default:s(()=>[T("Delete")]),_:2},1032,["onClick"])])]),_:2},1536)]),_:2},1024))),128))]),_:1})])])]),_:1},8,["max-height"])]),_:1},8,["modelValue"]),t(jt,{modelValue:e.value,"onUpdate:modelValue":d[2]||(d[2]=P=>e.value=P),selectedDevice:c.value,iconBgColor:k,onSelectEmoji:x,PropsMap:Z(j)},null,8,["modelValue","selectedDevice","PropsMap"]),a("div",eo,[t(y,{class:"dail-button",type:"primary",onClick:d[3]||(d[3]=P=>p.value=!0)},{default:s(()=>[to,T("Items ")]),_:1})])],64)}}},ao=R(oo,[["__scopeId","data-v-b1e95d67"]]),be={__name:"MainApp",setup(r){const n=b(null),p=b(null),e=b({}),o=te({}),l={layers:["findmy-point","findmy-route","line-arrows","findmy-heatmap"],sources:["findmy-data"]},i=v=>{e.value.data=v,e.value.status="GeoJSONLayers",n.value.removeGeoJSONLayers(l.layers,l.sources),n.value.addGeoJSONLayers(v),n.value.FitBounds(v)},c=v=>{n.value.map.getStyle().layers[0].id=="amap-tiles"&&re.transform(v,re.WGS84,re.GCJ02)},D=v=>{e.value.data=v,e.value.status="HeatMap",n.value.removeGeoJSONLayers(l.layers,l.sources),n.value.addHeatmapLayer(v),n.value.FitBounds(v)},k=async v=>{v.mode="timerange",await p.value.fetchData(v);const x=p.value.exposedData;c(x),i(x)},h=async v=>{v.mode="timerange",await p.value.fetchData(v);const x=p.value.exposedData;c(x),D(x)},m=async v=>{const x={...v};x.dateTimeRange=[],x.mode="realtime",await p.value.fetchData(x);const S=p.value.exposedData;c(S),n.value.removeMarkers(),n.value.addRealtimeMarker(S),n.value.FitBounds(S)},w=v=>{o.value=v},I=async v=>{const x=te({idSelected:[],dateTimeRange:[],mode:"realtime"});Object.values(v).forEach(V=>{x.idSelected.push(V.pubKey)}),(await p.value.fetchData(x)).data.forEach(V=>{v[V.id].Lastupdate=V.isodatetime,v[V.id].Coordinate=[V.longitude,V.latitude]})};return W(()=>{}),(v,x)=>($(),N(q,null,[t(tt,{"items-props":o,onSubmit:k,onAddHeatMap:h,onRealtime:m},null,8,["items-props"]),t(ao,{onUpdateItemProps:w,onReqUpdateItemProps:I}),t(rt,{geodata:e.value,itemsPropMap:o,ref_key:"MapboxMainRef",ref:n},null,8,["geodata","itemsPropMap"]),t(me,{ref_key:"DataHandlerRef",ref:p},null,512),t(he,{data:o},null,8,["data"])],64))}},lo={__name:"App",setup(r){return(n,p)=>($(),B(be))}};Le({history:Ve("/FindMyTrackPage/"),routes:[{path:"/",name:"home",component:be}]});Ie.add(Ne);const oe=Ce(lo);oe.component("font-awesome-icon",Te);for(const[r,n]of Object.entries(Pe))oe.component(r,n);oe.use(Me,{locale:je});oe.mount("#app");
