import{$ as ie,o as S,c as I,g as o,k as s,a as l,d as be,W as _,e as W,w as Q,j as B,y as N,F as q,r as de,a0 as ce,a1 as ue,b as se,a2 as we,C as re,l as Y,m as De,J as xe,v as ne,_ as ke}from"./vue-vrn0zMNo.js";import{H as Ce}from"./@vuepic-CJcSshu8.js";import{u as Z,a as w,r as ee,d as H,c as ge}from"./@vue-CojEnYtN.js";import{m as F}from"./mapbox-gl-DWMaBres.js";import{M as $e}from"./@mapbox-xjKLDsbk.js";import"./tinycolor2-CfovpC5H.js";import{P as _e}from"./vue3-emoji-picker-BI_Z11BT.js";import{c as Se,a as Le}from"./vue-router-h5yuP0F9.js";import{i as Ve,z as Me}from"./element-plus-17KCLzoK.js";import"./vue3-openlayers-DEL4v-Rs.js";import{Q as je}from"./@element-plus-Qx67WbJO.js";import{l as Pe,f as Ie,F as Ne}from"./@fortawesome-DNkv1NAJ.js";import"./date-fns-DjqgiLk-.js";import"./lodash-es-CiJSjksT.js";import"./@vueuse-CZ3kz2oL.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-n4Xreh4I.js";import"./async-validator-CiEh-HP4.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-B-WCBpf0.js";import"./ol-PaOofTtg.js";import"./rbush-DoHIURGA.js";import"./quickselect-cI_fw6Fh.js";import"./color-space-CC1atxIw.js";import"./color-rgba-QbDrIVEx.js";import"./color-parse-D1WSI7GZ.js";import"./color-name-XvCybByO.js";import"./earcut-DymNFgKl.js";import"./ol-ext-DKhM1omF.js";import"./ol-contextmenu-DtPVqisZ.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&e(i)}).observe(document,{childList:!0,subtree:!0});function u(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function e(t){if(t.ep)return;t.ep=!0;const a=u(t);fetch(t.href,a)}})();const U=(r,n)=>{const u=r.__vccOpts||r;for(const[e,t]of n)u[e]=t;return u},Te={class:"daterangepicker"},He={class:"sidebar"},Oe={__name:"VueDatePicker",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(r){const n=ie(r,"modelValue");if(!n.value||n.value.length===0){const a=new Date,i=new Date(new Date().setDate(a.getDate()-7));n.value=[i,a]}const u=()=>{const a=new Date,i=new Date(new Date().setHours(a.getHours()-1));n.value=[i,a]},e=()=>{const a=new Date,i=new Date(new Date().setDate(a.getDate()-1));n.value=[i,a]},t=()=>{const a=new Date,i=new Date(new Date().setDate(a.getDate()-7));n.value=[i,a]};return(a,i)=>(S(),I("div",Te,[o(Z(Ce),{modelValue:n.value,"onUpdate:modelValue":i[3]||(i[3]=b=>n.value=b),teleport:!0,range:""},{"right-sidebar":s(()=>[l("div",He,[l("div",{class:"sidebar-div",onClick:i[0]||(i[0]=b=>u())},"Last Hour"),l("div",{class:"sidebar-div",onClick:i[1]||(i[1]=b=>e())},"Last Day"),l("div",{class:"sidebar-div",onClick:i[2]||(i[2]=b=>t())},"Last Week")])]),_:1},8,["modelValue"])]))}},fe=U(Oe,[["__scopeId","data-v-02a0f943"]]),Ee={class:"block"},Fe=be({__name:"ElementDateTimePicker",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(r){const n=ie(r,"modelValue");if(!n.value||n.value.length===0){const e=new Date,t=new Date(new Date().setDate(e.getDate()-7));n.value=[t,e]}const u=[{text:"Last day",value:()=>{const e=new Date,t=new Date;return t.setDate(t.getDate()-1),[t,e]}},{text:"Last week",value:()=>{const e=new Date,t=new Date;return t.setDate(t.getDate()-7),[t,e]}},{text:"Last month",value:()=>{const e=new Date,t=new Date;return t.setMonth(t.getMonth()-1),[t,e]}},{text:"Last 3 months",value:()=>{const e=new Date,t=new Date;return t.setMonth(t.getMonth()-3),[t,e]}}];return(e,t)=>{const a=_("el-date-picker");return S(),I("div",Ee,[o(a,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=i=>n.value=i),type:"datetimerange",shortcuts:u,"range-separator":"To","start-placeholder":"Start date","end-placeholder":"End date"},null,8,["modelValue"])])}}}),Re=U(Fe,[["__scopeId","data-v-aadf7784"]]),Ue={__name:"GeoJSONConverter",props:{data:{type:Object,required:!0,default:{}}},setup(r,{expose:n}){const u=r,e=w({}),t=a=>{if(Object.keys(a).length>0){const i=a.data,b=[...i].sort((D,v)=>new Date(D.isodatetime)-new Date(v.isodatetime)),m=b.map(D=>({type:"Feature",properties:{name:D.id_short,id:D.id,conf:D.conf,status:D.status,TimeStamp:D.isodatetime,statusCode:D.statusCode},geometry:{type:"Point",coordinates:[D.longitude,D.latitude]}})),$=new Map,g=new Set([...i].map(D=>D.id));for(const D of g){const v=b.filter(k=>k.id==D).map(k=>[k.longitude,k.latitude]);v.length>1&&$.set(D,v)}const p=Array.from($,([D,v])=>({type:"Feature",properties:{id:D},geometry:{type:"LineString",coordinates:v,direction:"forward","arrow-symbol":"triangle"}}));e.value={type:"FeatureCollection",features:[...m,...p]}}};return W(()=>{Q(()=>u.data,a=>{Object.keys(a).length>0&&t(a)},{immediate:!0})}),n({convertToGeoJson:t,geoJsonData:e}),(a,i)=>null}},ze={__name:"DataHandler",props:{payload:{type:Object,default:{}}},setup(r,{expose:n}){const u=w(null),e=w(!0),t=w(null),a=w(),i=w(null),b=async m=>{const $={idArray:m.idSelected,dateTimeRange:{start:m.dateTimeRange[0],end:m.dateTimeRange[1]},mode:m.mode};try{const g=await fetch("https://fmt.geeek.cf/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($)});if(!g.ok)throw new Error(`Error: ${g.statusText}`);const p=await g.json();return p&&(a.value=p),p}catch(g){t.value=g.message}finally{e.value=!1}};return W(async()=>{Q(()=>u.value.geoJsonData,m=>{m&&(i.value=u.value.geoJsonData)},{immediate:!0})}),n({fetchData:b,exposedData:i}),(m,$)=>(S(),B(Ue,{data:a.value,ref_key:"Geojsondata",ref:u},null,8,["data"]))}},pe=U(ze,[["__scopeId","data-v-91e4577f"]]),ye={__name:"localStorage",props:{data:{type:Object,required:!0,default:{}}},setup(r){const u=r.data;return Q(()=>u,e=>{const t=JSON.stringify(e);localStorage.setItem("itemsProp",t)},{deep:!0}),(e,t)=>null}},X=r=>(ce("data-v-968f19c3"),r=r(),ue(),r),Ae={class:"main-layout-wrapper"},Ke={class:"main-layout"},Be=X(()=>l("i",{class:"fa-solid fa-list",style:{"margin-right":"10px"}},null,-1)),Je={id:"ButtomDrawer",style:{flex:"auto"}},Ge={class:"flex flex-wrap gap-4"},qe=X(()=>l("span",{class:"hide-small",style:{"vertical-align":"middle"}}," Clear ",-1)),We={class:"flex"},Ye=X(()=>l("i",{class:"fa-regular fa-square-check hide-small margin-right"},null,-1)),Ze=X(()=>l("i",{class:"fa-solid fa-fire hide-small margin-right"},null,-1)),Qe=X(()=>l("i",{class:"fa-regular fa-clock hide-small margin-right"},null,-1)),Xe={__name:"MainPanel",props:{itemsProps:{type:Object,default:{}}},emits:["submit","addHeatMap","realtime"],setup(r,{emit:n}){const u=w(!1),e=w("btt"),t=w([]),a=w({}),i=w(null),b=w({}),m=ee({idSelected:[],dateTimeRange:{start:"",end:""},mode:""}),$=r,g=n,p=()=>{m.idSelected.length>0&&Array.from(m.dateTimeRange).length>1&&g("submit",m)},D=()=>{m.idSelected.length>0&&Array.from(m.dateTimeRange).length>1&&g("addHeatMap",m)},v=()=>{m.idSelected.length>0&&g("realtime",m)},k=()=>{m.idSelected=[]};return W(()=>{m.dateTimeRange=t.value,Q(()=>t.value,P=>{m.dateTimeRange=P,a.value=P}),Q(()=>m,P=>{a.value=P},{deep:!0})}),(P,x)=>{const O=_("el-button"),V=_("el-option"),J=_("el-select"),A=_("el-col"),M=_("CircleClose"),y=_("el-icon"),d=_("el-row"),c=_("el-form-item"),f=_("el-form"),C=_("el-card"),L=_("el-drawer");return S(),I(q,null,[l("div",Ae,[l("div",Ke,[o(fe,{modelValue:t.value,"onUpdate:modelValue":x[0]||(x[0]=h=>t.value=h),range:"",class:"VueDatePicker"},null,8,["modelValue"])]),o(O,{class:"drawer-button",type:"primary",onClick:x[1]||(x[1]=h=>u.value=!0)},{default:s(()=>[Be,N("Data Select ")]),_:1}),o(pe,{payload:a.value,ref_key:"DataHandlerRef",ref:i},null,8,["payload"]),o(ye,{data:b.value},null,8,["data"])]),o(L,{modelValue:u.value,"onUpdate:modelValue":x[5]||(x[5]=h=>u.value=h),title:"Data select",direction:e.value,"with-header":!0,size:"60%"},{default:s(()=>[l("div",Je,[l("div",Ge,[o(C,{class:"card",shadow:"never",style:{"max-width":"600px"}},{default:s(()=>[o(f,{model:m,"label-width":"auto"},{default:s(()=>[o(c,{label:"Items select"},{default:s(()=>[o(d,{gutter:10},{default:s(()=>[o(A,{span:20},{default:s(()=>[o(J,{modelValue:m.idSelected,"onUpdate:modelValue":x[2]||(x[2]=h=>m.idSelected=h),multiple:"",filterable:"","default-first-option":"","reserve-keyword":!1,placeholder:"Choose your items",style:{"min-width":"150px"}},{default:s(()=>[(S(!0),I(q,null,de($.itemsProps.value,(h,T)=>(S(),B(V,{key:T,label:`${h.emoji} ${h.Name}`,value:h.pubKey},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(A,{span:4},{default:s(()=>[o(O,{onClick:k,type:"primary"},{default:s(()=>[o(y,{style:{"vertical-align":"middle"}},{default:s(()=>[o(M)]),_:1}),qe]),_:1})]),_:1})]),_:1})]),_:1}),o(c,{label:"Activity time",style:{"max-width":"600px"}},{default:s(()=>[o(A,{span:24},{default:s(()=>[o(Re,{class:"responsive-component",modelValue:t.value,"onUpdate:modelValue":x[3]||(x[3]=h=>t.value=h)},null,8,["modelValue"]),o(fe,{class:"responsive-component-display",modelValue:t.value,"onUpdate:modelValue":x[4]||(x[4]=h=>t.value=h),range:""},null,8,["modelValue"])]),_:1})]),_:1}),o(c,null,{default:s(()=>[l("div",We,[o(O,{type:"primary",onClick:p},{default:s(()=>[Ye,N("Get Data ")]),_:1}),o(O,{type:"primary",onClick:D},{default:s(()=>[Ze,N("HeatMap ")]),_:1}),o(O,{type:"primary",onClick:v},{default:s(()=>[Qe,N("RealTime ")]),_:1})])]),_:1})]),_:1},8,["model"])]),_:1})])])]),_:1},8,["modelValue","direction"])],64)}}},et=U(Xe,[["__scopeId","data-v-968f19c3"]]),tt={id:"menu"},ot={class:"input-label-row"},at=["id","value","checked"],lt=["for"],ve="streets",st={__name:"MapboxMain",props:{geodata:{type:Object,default:{}},itemsPropMap:{type:Object,default:{}}},setup(r,{expose:n}){const u=w(null),e=w(null),t=w(null);let a=!1;const i={ar:"ar",de:"de",en:"en",es:"es",fr:"fr",it:"it",ja:"ja",ko:"ko",mul:"mul",pt:"pt",ru:"ru",vi:"vi","zh-CN":"zh-Hans","zh-HK":"zh-Hant","zh-TW":"zh-Hant","zh-Hans":"zh-Hans","zh-Hant":"zh-Hant"},b=[],m="pk.eyJ1IjoiZ2Vla2NhdCIsImEiOiJjbHc5ZTJ6dmIwMTEyMmpudGowMXk5Y3o2In0.HDxYFBSNCpbYan731GLJEw",$=[{id:"satellite-streets",label:"Satellite Streets",url:"mapbox://styles/geekcat/clwc44om0008b01pn91yg82cg"},{id:"light-v11",label:"Light",url:"mapbox://styles/mapbox/light-v11"},{id:"dark-v11",label:"Dark",url:"mapbox://styles/mapbox/dark-v11"},{id:"streets",label:"Streets",url:"mapbox://styles/geekcat/clwxb0z8q01ep01pohp1h4q4d"},{id:"outdoors",label:"Outdoors",url:"mapbox://styles/geekcat/clwxbnita01es01po7fto915q"}],g=r,p=()=>{const d=navigator.language||navigator.userLanguage,c=navigator.language.split("-")[0];let f="mul";c=="zh"&&i[d]&&(f=i[d]),c!=="zh"&&i[c]&&(f=i[c]),F.setRTLTextPlugin("https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js");const C=new $e({defaultLanguage:f});e.value.language=f,e.value.setStyle(C.setLanguage(e.value.getStyle(),f)),e.value.addControl(C)},D=d=>{const c=d.target.value,f=$.find(C=>C.id===c).url;e.value&&(e.value.setStyle(f),g.geodata,e.value.once("style.load",()=>{g.geodata.status=="GeoJSONLayers"&&P(g.geodata.data),g.geodata.status=="HeatMap"&&k(g.geodata.data)}))},v=d=>{const c=["match",["get","id"]];return Object.entries(d).length>0&&Object.entries(d).forEach(([C,L])=>{c.push(C,L)}),c.push("#B42222"),c},k=d=>{Object.keys(d).length!=0&&(e.value.addSource("findmy-data",{type:"geojson",data:d}),e.value.addLayer({id:"findmy-heatmap",type:"heatmap",source:"findmy-data",maxzoom:17,paint:{"heatmap-intensity":["interpolate",["linear"],["zoom"],0,1,9,3,15,10],"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(33,102,172,0)",.2,"rgb(103,169,207)",.4,"rgb(209,229,240)",.6,"rgb(253,219,199)",.8,"rgb(239,138,98)",1,"rgb(178,24,43)"],"heatmap-radius":["interpolate",["linear"],["zoom"],0,2,9,15],"heatmap-opacity":["interpolate",["linear"],["zoom"],0,.6,10,.7,17,1]},filter:["==","$type","Point"]}))},P=d=>{if(Object.keys(d).length==0)return;const c={},f={};Object.entries(g.itemsPropMap.value).forEach(h=>{const[T,E]=h;c[T]=E.pointColor,f[T]=E.lineColor});const C=v(c),L=v(f);e.value.addSource("findmy-data",{type:"geojson",data:d}),e.value.addLayer({id:"findmy-point",type:"circle",source:"findmy-data",paint:{"circle-radius":6,"circle-color":C},filter:["==","$type","Point"]}),e.value.addLayer({id:"findmy-route",type:"line",source:"findmy-data",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":L,"line-width":3,"line-dasharray":[1,2]},filter:["==","$type","LineString"]}),e.value.addLayer({id:"line-arrows",type:"symbol",source:"findmy-data",layout:{"symbol-placement":"line","text-field":"▶","text-size":24,"symbol-spacing":50,"text-keep-upright":!1},paint:{"text-color":"red"},filter:["==","$type","LineString"]})},x=(d,c)=>{d.forEach(f=>{e.value.getLayer(f)&&e.value.removeLayer(f)}),c.forEach(f=>{e.value.getSource(f)&&e.value.removeSource(f)})},O=d=>{const c=new F.LngLatBounds;d.features.forEach(function(f){const C=f.geometry.coordinates;c.extend(C)}),e.value.fitBounds(c,{padding:20})},V=d=>{const c=["in",["get","name"],["literal",d]];e.value.setFilter("findmy-point",c),e.value.setFilter("findmy-route",c),e.value.setFilter("line-arrows",c),a=!0},J=()=>{e.value.setFilter("findmy-point",null),e.value.setFilter("findmy-route",null),e.value.setFilter("line-arrows",null),a=!1},A=d=>{for(const c of d.features){const f=c.properties.id,C=document.createElement("div");C.className="marker";const L=document.createElement("div");if(L.className="markerWrapper",L.innerHTML='<div class="emoji-wrapper">🌏</div>',g.itemsPropMap.value[f].emoji){const le=g.itemsPropMap.value[f].emoji;L.innerHTML=`<div class="emoji-wrapper">${le}</div>`}C.appendChild(L);const h=c.properties.name,T=c.geometry.coordinates,E=T.join(","),R=c.properties.TimeStamp,oe=new F.Popup({offset:25}).setHTML(`<strong>Name:</strong> ${h}<br/><strong>Coordinates:</strong> ${E}<br/><strong>Timestamp:</strong> ${R}`),ae=new F.Marker(C).setLngLat(T).setPopup(oe).addTo(e.value);b.push(ae)}},M=()=>{if(b.length>0)for(const d of b)d.remove()},y=new F.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0});return n({map:e,switchStyle:D,setStyleLanguage:p,geometryColorSet:v,addHeatmapLayer:k,addGeoJSONLayers:P,removeGeoJSONLayers:x,setMapFilter:V,removeMapFilter:J,FitBounds:O,addRealtimeMarker:A,removeMarkers:M}),W(()=>{F.accessToken=m;const d=[104.0657,30.6594];e.value=new F.Map({container:u.value,style:$.find(c=>c.id===ve).url,center:d,zoom:2}),e.value.on("load",()=>{p()}),e.value.on("mouseenter","findmy-point",c=>{e.value.getCanvas().style.cursor="pointer";const f=a?1:0,C=c.features[f].geometry.coordinates.slice(),L=C.map(R=>R.toFixed(4).toString()),h=c.features[f].properties.TimeStamp,T=c.features[f].properties.name,E=new F.Popup({offset:25}).setLngLat(C).setHTML(`<strong>Name:</strong> ${T}<br/><strong>Coordinates:</strong> ${L}<br/><strong>Timestamp:</strong> ${h}`).addTo(e.value);e.value.on("mouseleave","findmy-point",()=>{e.value.getCanvas().style.cursor="",E.remove()})}),e.value.on("click","findmy-point",c=>{const f=a?1:0,C=c.features[f].geometry.coordinates.slice(),L=C.map(E=>E.toFixed(4).toString()),h=c.features[f].properties.TimeStamp,T=c.features[f].properties.name;new F.Popup({offset:25}).setLngLat(C).setHTML(`<strong>Name:</strong> ${T}<br/><strong>Coordinates:</strong> ${L}<br/><strong>Timestamp:</strong> ${h}`).addTo(e.value)}),e.value.addControl(new F.NavigationControl),e.value.addControl(y)}),(d,c)=>{const f=_("el-row"),C=_("el-col");return S(),I("div",null,[l("div",{id:"map",ref_key:"mapContainer",ref:u},null,512),o(pe,{ref_key:"DataHandlerRef",ref:t},null,512),l("div",tt,[o(C,null,{default:s(()=>[(S(),I(q,null,de($,L=>o(f,{span:6,key:L.id},{default:s(()=>[l("div",ot,[l("input",{id:L.id,type:"radio",name:"rtoggle",value:L.id,checked:L.id===ve,onChange:D},null,40,at),l("label",{for:L.id},H(L.label),9,lt)])]),_:2},1024)),64))]),_:1})])])}}},nt=U(st,[["__scopeId","data-v-0c40c64c"]]),me=r=>(ce("data-v-1aee86ef"),r=r(),ue(),r),rt={class:"flex-row-center"},it={class:"flex-row"},dt=me(()=>l("div",{class:"margin-right"},"iconColor:",-1)),ct={class:"flex-row"},ut=me(()=>l("div",{class:"margin-right"},"pointColor:",-1)),pt={class:"flex-row"},mt=me(()=>l("div",{class:"margin-right"},"lineColor:",-1)),ft={__name:"ColorPicker",props:{PropsMap:Object,selectedDevice:Object},setup(r){const n=r,u=se({get(){return n.selectedDevice.prop.bgColor},set(i){n.selectedDevice.prop.bgColor=i}}),e=se({get(){return n.selectedDevice.prop.pointColor},set(i){n.selectedDevice.prop.pointColor=i}}),t=se({get(){return n.selectedDevice.prop.lineColor},set(i){n.selectedDevice.prop.lineColor=i}}),a=w(["#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","rgb(255, 120, 0)","#c7158577"]);return(i,b)=>{const m=_("el-color-picker"),$=_("el-col"),g=_("el-row");return S(),I("div",rt,[o(g,{gutter:10},{default:s(()=>[o($,{xs:24,sm:24,md:8,lg:8},{default:s(()=>[l("div",it,[dt,o(m,{modelValue:u.value,"onUpdate:modelValue":b[0]||(b[0]=p=>u.value=p),predefine:a.value},null,8,["modelValue","predefine"])])]),_:1}),o($,{xs:24,sm:24,md:8,lg:8},{default:s(()=>[l("div",ct,[ut,o(m,{modelValue:e.value,"onUpdate:modelValue":b[1]||(b[1]=p=>e.value=p),predefine:a.value},null,8,["modelValue","predefine"])])]),_:1}),o($,{xs:24,sm:24,md:8,lg:8},{default:s(()=>[l("div",pt,[mt,o(m,{modelValue:t.value,"onUpdate:modelValue":b[2]||(b[2]=p=>t.value=p),predefine:a.value},null,8,["modelValue","predefine"])])]),_:1})]),_:1})])}}},vt=U(ft,[["__scopeId","data-v-1aee86ef"]]),gt={key:0,class:"flex-column"},_t={class:"justify-center"},yt={class:"Emoji-2x"},ht={class:"Edit-info-div"},bt={class:"Edit-info-div-inner"},wt={class:"info-item flex-prop"},Dt={key:0,class:"single-line-text"},xt={class:"info-item flex-prop"},kt={key:0,class:"single-line-text"},Ct={class:"info-item flex-prop"},$t={key:0,class:"single-line-text"},St={class:"info-item flex-prop"},Lt={key:0,class:"single-line-text"},Vt={__name:"EditDeviceDialog",props:we({dialogEditVisible:Boolean,selectedDevice:Object,iconBgColor:Function,onSelectEmoji:Function},{modelValue:{prop:"modelValue",event:"update:modelValue"},modelModifiers:{}}),emits:["update:modelValue"],setup(r){const n=r,u=ie(r,"modelValue"),e=w(!1),t=w(!1),a=w(!1),i=w(!1),b=w(!1),m=g=>{if(!b.value)switch(b.value=!0,setTimeout(()=>{b.value=!1},100),g){case"Name":e.value=!e.value;break;case"pubKey":t.value=!t.value;break;case"Location":a.value=!a.value;break;case"Lastupdate":i.value=!i.value;break}},$=g=>{m(g)};return(g,p)=>{const D=_("el-button"),v=_("el-popover"),k=_("el-col"),P=_("el-input"),x=_("el-row"),O=_("el-dialog");return S(),B(O,{modelValue:u.value,"onUpdate:modelValue":p[9]||(p[9]=V=>u.value=V),title:"Edit Device",draggable:"",width:"50%",class:"responsive-dialog"},{default:s(()=>[r.selectedDevice?(S(),I("div",gt,[o(x,{gutter:10},{default:s(()=>[o(k,{xs:24,sm:24,md:6,lg:4},{default:s(()=>[l("div",_t,[o(v,{placement:"top",title:"Icon Picker",width:300,trigger:"click"},{reference:s(()=>[o(D,{class:"icon-div-2x",style:ge(r.iconBgColor(r.selectedDevice.prop.bgColor))},{default:s(()=>[l("div",yt,H(r.selectedDevice.prop.emoji),1)]),_:1},8,["style"])]),default:s(()=>[o(Z(_e),{native:!0,onSelect:p[0]||(p[0]=V=>r.onSelectEmoji(V,r.selectedDevice.id))})]),_:1})])]),_:1}),o(k,{xs:24,sm:24,md:18,lg:20},{default:s(()=>[l("div",ht,[l("div",bt,[l("div",wt,[N(" Name: "),e.value?(S(),B(P,{key:1,modelValue:r.selectedDevice.prop.Name,"onUpdate:modelValue":p[1]||(p[1]=V=>r.selectedDevice.prop.Name=V),onBlur:p[2]||(p[2]=V=>$("Name")),onKeyup:p[3]||(p[3]=re(V=>$("Name"),["enter"]))},null,8,["modelValue"])):(S(),I("span",Dt,H(r.selectedDevice.prop.Name),1)),l("i",{onClick:p[4]||(p[4]=V=>m("Name")),class:"fas fa-edit edit-icon"})]),l("div",xt,[N(" pubKey: "),t.value?(S(),B(P,{key:1,modelValue:r.selectedDevice.prop.pubKey,"onUpdate:modelValue":p[5]||(p[5]=V=>r.selectedDevice.prop.pubKey=V),onBlur:p[6]||(p[6]=V=>$("pubKey")),onKeyup:p[7]||(p[7]=re(V=>$("pubKey"),["enter"]))},null,8,["modelValue"])):(S(),I("span",kt,H(r.selectedDevice.prop.pubKey),1)),l("i",{onClick:p[8]||(p[8]=V=>m("pubKey")),class:"fas fa-edit edit-icon"})]),l("div",Ct,[N(" Location: "),a.value?Y("",!0):(S(),I("span",$t,H(r.selectedDevice.prop.Location),1))]),l("div",St,[N(" Lastupdate: "),i.value?Y("",!0):(S(),I("span",Lt,H(r.selectedDevice.prop.Lastupdate),1))])])])]),_:1})]),_:1}),o(vt,De(g.$attrs,{selectedDevice:n.selectedDevice}),null,16,["selectedDevice"])])):Y("",!0)]),_:1},8,["modelValue"])}}},Mt=U(Vt,[["__scopeId","data-v-50657422"]]),z=r=>(ce("data-v-d622276d"),r=r(),ue(),r),jt={class:"manageForm"},Pt=z(()=>l("span",{class:"hide-small",style:{"vertical-align":"middle"}}," Add ",-1)),It={class:"justify-end"},Nt=z(()=>l("i",{class:"fa-solid fa-trash margin-right"},null,-1)),Tt=z(()=>l("span",{class:"hide-small",style:{"vertical-align":"middle"}}," Clear All",-1)),Ht=z(()=>l("i",{class:"fa-solid fa-rotate-right margin-right"},null,-1)),Ot=z(()=>l("span",{class:"hide-small",style:{"vertical-align":"middle"}}," Refresh ",-1)),Et={class:"scrolldiv"},Ft={class:"itemsdiv"},Rt={class:"card-inner"},Ut={class:"Emoji"},zt={class:"item-prop"},At={class:"flex-prop"},Kt={class:"flex-wrap"},Bt={key:0},Jt=z(()=>l("i",{class:"fa-solid fa-copy"},null,-1)),Gt={class:"flex-prop"},qt={class:"flex-wrap"},Wt={key:0},Yt=z(()=>l("i",{class:"fa-solid fa-copy"},null,-1)),Zt={class:"single-line-text"},Qt={class:"single-line-text"},Xt={class:"main-layout-wrapper"},eo=z(()=>l("i",{class:"fa-solid fa-box-archive",style:{"margin-right":"10px"}},null,-1)),to={__name:"itemsManage",props:{propsMap:{type:Object,default:{}}},emits:["updateItemProps","reqUpdateItemProps"],setup(r,{emit:n}){const u=w(!1),e=w(!1),t=w(""),a=w(new Set),i=w(null),b=w(null),m=n,$=y=>y?`background-color:${y}`:"",g=w("350px"),p=()=>{const y=window.innerWidth,d=window.innerHeight;g.value=d*.5+"px",y<=768&&(g.value=d*.6+"px")};W(()=>{p(),window.addEventListener("resize",p),A()}),xe(()=>{window.removeEventListener("resize",p)});const D=y=>{b.value={id:y,prop:M[y]},e.value=!0},v=y=>{i.value=y},k=y=>{y in M&&delete M[y]},P=(y,d)=>{M[d].emoji=y.i,M[d].emojiName=y.n[0],M[d].emojiValue=y.u},x=()=>{const y=t.value;if(y&&!a.value.has(y)){a.value.add(y);const d=y;M[d]={emoji:"🌏",emojiName:"",emojiValue:"",bgColor:"#FFFFFF",pointColor:"red",lineColor:"blue",Name:y,serialNum:"N/A",pubKey:d,Lastupdate:"N/A",Added:new Date().toISOString(),Coordinate:["N/A","N/A"],Location:"N/A"},m("updateItemProps",M),t.value=""}},O=()=>{m("reqUpdateItemProps",M)},V=()=>{Object.keys(M).forEach(y=>{delete M[y]})},J=y=>{navigator.clipboard.writeText(y).then(()=>{console.log("Copied to clipboard successfully!")},d=>{console.error("Could not copy text: ",d)})},A=()=>{if(localStorage.getItem("itemsProp")){const y=localStorage.getItem("itemsProp"),d=JSON.parse(y);Object.assign(M,d.value),m("updateItemProps",M)}};let M=ee({});return(y,d)=>{const c=_("el-input"),f=_("el-col"),C=_("CirclePlus"),L=_("el-icon"),h=_("el-button"),T=_("el-popconfirm"),E=_("el-row"),R=_("el-popover"),oe=_("el-card"),ae=_("el-scrollbar"),le=_("el-dialog");return S(),I(q,null,[o(le,{modelValue:u.value,"onUpdate:modelValue":d[1]||(d[1]=j=>u.value=j),title:"Items Manage",draggable:"",class:"itemsManageDial",width:"95%"},{default:s(()=>[l("div",jt,[o(E,{gutter:20},{default:s(()=>[o(f,{xs:12,sm:8},{default:s(()=>[o(c,{modelValue:t.value,"onUpdate:modelValue":d[0]||(d[0]=j=>t.value=j),onKeydown:re(x,["enter"])},null,8,["modelValue"])]),_:1}),o(f,{xs:4,sm:4},{default:s(()=>[o(h,{type:"primary",onClick:x},{default:s(()=>[o(L,{style:{"vertical-align":"middle"}},{default:s(()=>[o(C)]),_:1}),Pt]),_:1})]),_:1}),o(f,{xs:4,sm:8}),o(f,{xs:4,sm:4},{default:s(()=>[l("div",It,[o(T,{"confirm-button-text":"Yes","cancel-button-text":"No","icon-color":"red",title:"Are you sure to delete All items?",onConfirm:V},{reference:s(()=>[o(h,{class:"clear-button",type:"danger"},{default:s(()=>[Nt,Tt]),_:1})]),_:1}),o(h,{class:"refresh-button",type:"primary",onClick:O},{default:s(()=>[Ht,Ot]),_:1})])]),_:1})]),_:1})]),o(ae,{"max-height":g.value},{default:s(()=>[l("div",Et,[l("div",Ft,[o(E,{gutter:10},{default:s(()=>[(S(!0),I(q,null,de(Z(M),(j,G)=>(S(),B(f,{key:G,xs:24,sm:12,md:8,lg:6},{default:s(()=>[o(R,{ref_for:!0,ref:"popover",placement:"top",title:"Options",width:200,trigger:"contextmenu"},{reference:s(()=>[o(oe,{class:"card",shadow:"hover",onClick:K=>D(G)},{default:s(()=>[l("div",Rt,[o(R,{placement:"right",title:"Icon Picker",width:300,trigger:"click"},{reference:s(()=>[o(h,{class:"icon-div",onClick:ne(K=>v(G),["stop"]),style:ge($(j.bgColor))},{default:s(()=>[l("div",Ut,H(j.emoji),1)]),_:2},1032,["onClick","style"])]),default:s(()=>[o(Z(_e),{native:!0,onSelect:K=>P(K,G)},null,8,["onSelect"])]),_:2},1024),l("div",zt,[l("div",At,[N("Name: "),o(R,{trigger:"hover",placement:"top"},{reference:s(()=>[l("div",Kt,[N(H(j.Name.substring(0,13))+" ",1),j.Name.length>10?(S(),I("div",Bt,"... ")):Y("",!0),o(h,{link:"",onClick:ne(K=>J(j.Name),["stop"])},{default:s(()=>[Jt]),_:2},1032,["onClick"])])]),default:s(()=>[l("div",null,H(j.Name),1)]),_:2},1024)]),l("div",Gt,[N("pubKey: "),o(R,{trigger:"hover",placement:"top"},{reference:s(()=>[l("div",qt,[N(H(j.pubKey.substring(0,13))+" ",1),j.pubKey.length>10?(S(),I("div",Wt,"... ")):Y("",!0),o(h,{link:"",onClick:ne(K=>J(j.pubKey),["stop"])},{default:s(()=>[Yt]),_:2},1032,["onClick"])])]),default:s(()=>[l("div",null,H(j.pubKey),1)]),_:2},1024)]),l("div",Zt,"Location: "+H(j.Location),1),l("div",Qt,"LastUpdate: "+H(j.Lastupdate),1)])])]),_:2},1032,["onClick"])]),default:s(()=>[l("div",null,[o(h,{onClick:K=>D(G)},{default:s(()=>[N("Edit")]),_:2},1032,["onClick"]),o(h,{type:"danger",onClick:K=>k(G)},{default:s(()=>[N("Delete")]),_:2},1032,["onClick"])])]),_:2},1536)]),_:2},1024))),128))]),_:1})])])]),_:1},8,["max-height"])]),_:1},8,["modelValue"]),o(Mt,{modelValue:e.value,"onUpdate:modelValue":d[2]||(d[2]=j=>e.value=j),selectedDevice:b.value,iconBgColor:$,onSelectEmoji:P,PropsMap:Z(M)},null,8,["modelValue","selectedDevice","PropsMap"]),l("div",Xt,[o(h,{class:"dail-button",type:"primary",onClick:d[3]||(d[3]=j=>u.value=!0)},{default:s(()=>[eo,N("Items ")]),_:1})])],64)}}},oo=U(to,[["__scopeId","data-v-d622276d"]]),he={__name:"MainApp",setup(r){const n=w(null),u=w(null),e=w({}),t=ee({}),a={layers:["findmy-point","findmy-route","line-arrows","findmy-heatmap"],sources:["findmy-data"]},i=v=>{e.value.data=v,e.value.status="GeoJSONLayers",n.value.removeGeoJSONLayers(a.layers,a.sources),n.value.addGeoJSONLayers(v),n.value.FitBounds(v)},b=v=>{e.value.data=v,e.value.status="HeatMap",n.value.removeGeoJSONLayers(a.layers,a.sources),n.value.addHeatmapLayer(v),n.value.FitBounds(v)},m=async v=>{v.mode="timerange",await u.value.fetchData(v);const k=u.value.exposedData;i(k)},$=async v=>{v.mode="timerange",await u.value.fetchData(v);const k=u.value.exposedData;b(k)},g=async v=>{const k={...v};k.dateTimeRange=[],k.mode="realtime",await u.value.fetchData(k);const P=u.value.exposedData;n.value.removeMarkers(),n.value.addRealtimeMarker(P),n.value.FitBounds(P)},p=v=>{t.value=v},D=async v=>{const k=ee({idSelected:[],dateTimeRange:[],mode:"realtime"});Object.values(v).forEach(x=>{k.idSelected.push(x.pubKey)}),(await u.value.fetchData(k)).data.forEach(x=>{v[x.id].Lastupdate=x.isodatetime,v[x.id].Coordinate=[x.longitude,x.latitude]})};return W(()=>{}),(v,k)=>(S(),I(q,null,[o(et,{"items-props":t,onSubmit:m,onAddHeatMap:$,onRealtime:g},null,8,["items-props"]),o(oo,{onUpdateItemProps:p,onReqUpdateItemProps:D}),o(nt,{geodata:e.value,itemsPropMap:t,ref_key:"MapboxMainRef",ref:n},null,8,["geodata","itemsPropMap"]),o(pe,{ref_key:"DataHandlerRef",ref:u},null,512),o(ye,{data:t},null,8,["data"])],64))}},ao={__name:"App",setup(r){return(n,u)=>(S(),B(he))}};Se({history:Le("/FindMyTrackPage/"),routes:[{path:"/",name:"home",component:he}]});Pe.add(Ie);const te=ke(ao);te.component("font-awesome-icon",Ne);for(const[r,n]of Object.entries(je))te.component(r,n);te.use(Ve,{locale:Me});te.mount("#app");
