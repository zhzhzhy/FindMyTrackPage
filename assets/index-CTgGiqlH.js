import{$ as de,o as $,c as N,g as o,k as s,a as l,d as we,W as g,e as W,w as Q,j as B,y as T,F as q,r as ce,a0 as ue,a1 as pe,b as se,a2 as xe,C as ie,l as Y,m as De,J as ke,v as ne,_ as Ce}from"./vue-vrn0zMNo.js";import{H as Se}from"./@vuepic-CJcSshu8.js";import{u as Z,a as w,r as ee,d as O,c as _e}from"./@vue-CojEnYtN.js";import{m as F}from"./mapbox-gl-DWMaBres.js";import{M as $e}from"./@mapbox-xjKLDsbk.js";import"./tinycolor2-CfovpC5H.js";import{P as ye}from"./vue3-emoji-picker-BI_Z11BT.js";import{e as re}from"./gcoord-CaovwXKb.js";import{c as Le,a as Ve}from"./vue-router-h5yuP0F9.js";import{i as Me,z as je}from"./element-plus-17KCLzoK.js";import"./vue3-openlayers-DEL4v-Rs.js";import{Q as Pe}from"./@element-plus-Qx67WbJO.js";import{l as Ie,f as Ne,F as Te}from"./@fortawesome-DNkv1NAJ.js";import"./date-fns-DjqgiLk-.js";import"./lodash-es-CiJSjksT.js";import"./@vueuse-CZ3kz2oL.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-n4Xreh4I.js";import"./async-validator-CiEh-HP4.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-B-WCBpf0.js";import"./ol-PaOofTtg.js";import"./rbush-DoHIURGA.js";import"./quickselect-cI_fw6Fh.js";import"./color-space-CC1atxIw.js";import"./color-rgba-QbDrIVEx.js";import"./color-parse-D1WSI7GZ.js";import"./color-name-XvCybByO.js";import"./earcut-DymNFgKl.js";import"./ol-ext-DKhM1omF.js";import"./ol-contextmenu-DtPVqisZ.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&e(i)}).observe(document,{childList:!0,subtree:!0});function u(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function e(t){if(t.ep)return;t.ep=!0;const a=u(t);fetch(t.href,a)}})();const R=(r,n)=>{const u=r.__vccOpts||r;for(const[e,t]of n)u[e]=t;return u},He={class:"daterangepicker"},Oe={class:"sidebar"},Ee={__name:"VueDatePicker",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(r){const n=de(r,"modelValue");if(!n.value||n.value.length===0){const a=new Date,i=new Date(new Date().setDate(a.getDate()-7));n.value=[i,a]}const u=()=>{const a=new Date,i=new Date(new Date().setHours(a.getHours()-1));n.value=[i,a]},e=()=>{const a=new Date,i=new Date(new Date().setDate(a.getDate()-1));n.value=[i,a]},t=()=>{const a=new Date,i=new Date(new Date().setDate(a.getDate()-7));n.value=[i,a]};return(a,i)=>($(),N("div",He,[o(Z(Se),{modelValue:n.value,"onUpdate:modelValue":i[3]||(i[3]=_=>n.value=_),teleport:!0,range:""},{"right-sidebar":s(()=>[l("div",Oe,[l("div",{class:"sidebar-div",onClick:i[0]||(i[0]=_=>u())},"Last Hour"),l("div",{class:"sidebar-div",onClick:i[1]||(i[1]=_=>e())},"Last Day"),l("div",{class:"sidebar-div",onClick:i[2]||(i[2]=_=>t())},"Last Week")])]),_:1},8,["modelValue"])]))}},ve=R(Ee,[["__scopeId","data-v-02a0f943"]]),Fe={class:"block"},ze=we({__name:"ElementDateTimePicker",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(r){const n=de(r,"modelValue");if(!n.value||n.value.length===0){const e=new Date,t=new Date(new Date().setDate(e.getDate()-7));n.value=[t,e]}const u=[{text:"Last day",value:()=>{const e=new Date,t=new Date;return t.setDate(t.getDate()-1),[t,e]}},{text:"Last week",value:()=>{const e=new Date,t=new Date;return t.setDate(t.getDate()-7),[t,e]}},{text:"Last month",value:()=>{const e=new Date,t=new Date;return t.setMonth(t.getMonth()-1),[t,e]}},{text:"Last 3 months",value:()=>{const e=new Date,t=new Date;return t.setMonth(t.getMonth()-3),[t,e]}}];return(e,t)=>{const a=g("el-date-picker");return $(),N("div",Fe,[o(a,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=i=>n.value=i),type:"datetimerange",shortcuts:u,"range-separator":"To","start-placeholder":"Start date","end-placeholder":"End date"},null,8,["modelValue"])])}}}),Re=R(ze,[["__scopeId","data-v-aadf7784"]]),Ue={__name:"GeoJSONConverter",props:{data:{type:Object,required:!0,default:{}}},setup(r,{expose:n}){const u=r,e=w({}),t=a=>{if(Object.keys(a).length>0){const i=a.data,_=[...i].sort((x,I)=>new Date(x.isodatetime)-new Date(I.isodatetime)),m=_.map(x=>({type:"Feature",properties:{name:x.id_short,id:x.id,conf:x.conf,status:x.status,TimeStamp:x.isodatetime,statusCode:x.statusCode},geometry:{type:"Point",coordinates:[x.longitude,x.latitude]}})),C=new Map,y=new Set([...i].map(x=>x.id));for(const x of y){const I=_.filter(v=>v.id==x).map(v=>[v.longitude,v.latitude]);I.length>1&&C.set(x,I)}const p=Array.from(C,([x,I])=>({type:"Feature",properties:{id:x},geometry:{type:"LineString",coordinates:I,direction:"forward","arrow-symbol":"triangle"}}));e.value={type:"FeatureCollection",features:[...m,...p]}}};return W(()=>{Q(()=>u.data,a=>{Object.keys(a).length>0&&t(a)},{immediate:!0})}),n({convertToGeoJson:t,geoJsonData:e}),(a,i)=>null}},Ae={__name:"DataHandler",props:{payload:{type:Object,default:{}}},setup(r,{expose:n}){const u=w(null),e=w(!0),t=w(null),a=w(),i=w(null),_=async m=>{const C={idArray:m.idSelected,dateTimeRange:{start:m.dateTimeRange[0],end:m.dateTimeRange[1]},mode:m.mode};try{const y=await fetch("https://fmt.geeek.cf/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)});if(!y.ok)throw new Error(`Error: ${y.statusText}`);const p=await y.json();return p&&(a.value=p),p}catch(y){t.value=y.message}finally{e.value=!1}};return W(async()=>{Q(()=>u.value.geoJsonData,m=>{m&&(i.value=u.value.geoJsonData)},{immediate:!0})}),n({fetchData:_,exposedData:i}),(m,C)=>($(),B(Ue,{data:a.value,ref_key:"Geojsondata",ref:u},null,8,["data"]))}},me=R(Ae,[["__scopeId","data-v-91e4577f"]]),he={__name:"localStorage",props:{data:{type:Object,required:!0,default:{}}},setup(r){const u=r.data;return Q(()=>u,e=>{const t=JSON.stringify(e);localStorage.setItem("itemsProp",t)},{deep:!0}),(e,t)=>null}},X=r=>(ue("data-v-968f19c3"),r=r(),pe(),r),Ke={class:"main-layout-wrapper"},Be={class:"main-layout"},Je=X(()=>l("i",{class:"fa-solid fa-list",style:{"margin-right":"10px"}},null,-1)),Ge={id:"ButtomDrawer",style:{flex:"auto"}},qe={class:"flex flex-wrap gap-4"},We=X(()=>l("span",{class:"hide-small",style:{"vertical-align":"middle"}}," Clear ",-1)),Ye={class:"flex"},Ze=X(()=>l("i",{class:"fa-regular fa-square-check hide-small margin-right"},null,-1)),Qe=X(()=>l("i",{class:"fa-solid fa-fire hide-small margin-right"},null,-1)),Xe=X(()=>l("i",{class:"fa-regular fa-clock hide-small margin-right"},null,-1)),et={__name:"MainPanel",props:{itemsProps:{type:Object,default:{}}},emits:["submit","addHeatMap","realtime"],setup(r,{emit:n}){const u=w(!1),e=w("btt"),t=w([]),a=w({}),i=w(null),_=w({}),m=ee({idSelected:[],dateTimeRange:{start:"",end:""},mode:""}),C=r,y=n,p=()=>{m.idSelected.length>0&&Array.from(m.dateTimeRange).length>1&&y("submit",m)},x=()=>{m.idSelected.length>0&&Array.from(m.dateTimeRange).length>1&&y("addHeatMap",m)},I=()=>{m.idSelected.length>0&&y("realtime",m)},v=()=>{m.idSelected=[]};return W(()=>{m.dateTimeRange=t.value,Q(()=>t.value,D=>{m.dateTimeRange=D,a.value=D}),Q(()=>m,D=>{a.value=D},{deep:!0})}),(D,S)=>{const V=g("el-button"),M=g("el-option"),J=g("el-select"),A=g("el-col"),j=g("CircleClose"),h=g("el-icon"),d=g("el-row"),c=g("el-form-item"),f=g("el-form"),k=g("el-card"),L=g("el-drawer");return $(),N(q,null,[l("div",Ke,[l("div",Be,[o(ve,{modelValue:t.value,"onUpdate:modelValue":S[0]||(S[0]=b=>t.value=b),range:"",class:"VueDatePicker"},null,8,["modelValue"])]),o(V,{class:"drawer-button",type:"primary",onClick:S[1]||(S[1]=b=>u.value=!0)},{default:s(()=>[Je,T("Data Select ")]),_:1}),o(me,{payload:a.value,ref_key:"DataHandlerRef",ref:i},null,8,["payload"]),o(he,{data:_.value},null,8,["data"])]),o(L,{modelValue:u.value,"onUpdate:modelValue":S[5]||(S[5]=b=>u.value=b),title:"Data select",direction:e.value,"with-header":!0,size:"60%"},{default:s(()=>[l("div",Ge,[l("div",qe,[o(k,{class:"card",shadow:"never",style:{"max-width":"600px"}},{default:s(()=>[o(f,{model:m,"label-width":"auto"},{default:s(()=>[o(c,{label:"Items select"},{default:s(()=>[o(d,{gutter:10},{default:s(()=>[o(A,{span:20},{default:s(()=>[o(J,{modelValue:m.idSelected,"onUpdate:modelValue":S[2]||(S[2]=b=>m.idSelected=b),multiple:"",filterable:"","default-first-option":"","reserve-keyword":!1,placeholder:"Choose your items",style:{"min-width":"150px"}},{default:s(()=>[($(!0),N(q,null,ce(C.itemsProps.value,(b,H)=>($(),B(M,{key:H,label:`${b.emoji} ${b.Name}`,value:b.pubKey},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(A,{span:4},{default:s(()=>[o(V,{onClick:v,type:"primary"},{default:s(()=>[o(h,{style:{"vertical-align":"middle"}},{default:s(()=>[o(j)]),_:1}),We]),_:1})]),_:1})]),_:1})]),_:1}),o(c,{label:"Activity time",style:{"max-width":"600px"}},{default:s(()=>[o(A,{span:24},{default:s(()=>[o(Re,{class:"responsive-component",modelValue:t.value,"onUpdate:modelValue":S[3]||(S[3]=b=>t.value=b)},null,8,["modelValue"]),o(ve,{class:"responsive-component-display",modelValue:t.value,"onUpdate:modelValue":S[4]||(S[4]=b=>t.value=b),range:""},null,8,["modelValue"])]),_:1})]),_:1}),o(c,null,{default:s(()=>[l("div",Ye,[o(V,{type:"primary",onClick:p},{default:s(()=>[Ze,T("Get Data ")]),_:1}),o(V,{type:"primary",onClick:x},{default:s(()=>[Qe,T("HeatMap ")]),_:1}),o(V,{type:"primary",onClick:I},{default:s(()=>[Xe,T("RealTime ")]),_:1})])]),_:1})]),_:1},8,["model"])]),_:1})])])]),_:1},8,["modelValue","direction"])],64)}}},tt=R(et,[["__scopeId","data-v-968f19c3"]]),ot={id:"menu"},at={class:"input-label-row"},lt=["id","value","checked"],st=["for"],ge="streets",nt={__name:"MapboxMain",props:{geodata:{type:Object,default:{}},itemsPropMap:{type:Object,default:{}}},setup(r,{expose:n}){const u=w(null),e=w(null),t=w(null);let a=!1;const i={ar:"ar",de:"de",en:"en",es:"es",fr:"fr",it:"it",ja:"ja",ko:"ko",mul:"mul",pt:"pt",ru:"ru",vi:"vi","zh-CN":"zh-Hans","zh-HK":"zh-Hant","zh-TW":"zh-Hant","zh-Hans":"zh-Hans","zh-Hant":"zh-Hant"},_=[],m="pk.eyJ1IjoiZ2Vla2NhdCIsImEiOiJjbHc5ZTJ6dmIwMTEyMmpudGowMXk5Y3o2In0.HDxYFBSNCpbYan731GLJEw",C=[{id:"satellite-streets",label:"Satellite Streets",url:"mapbox://styles/geekcat/clwc44om0008b01pn91yg82cg"},{id:"light-v11",label:"Light",url:"mapbox://styles/mapbox/light-v11"},{id:"dark-v11",label:"Dark",url:"mapbox://styles/mapbox/dark-v11"},{id:"streets",label:"Streets",url:"mapbox://styles/geekcat/clwxb0z8q01ep01pohp1h4q4d"},{id:"outdoors",label:"Outdoors",url:"mapbox://styles/geekcat/clwxbnita01es01po7fto915q"},{id:"amap",label:"È´òÂæ∑Âú∞Âõæ",url:{version:8,sources:{"raster-tiles":{type:"raster",tiles:["http://wprd04.is.autonavi.com/appmaptile?lang=zh_cn&size=1&style=7&x={x}&y={y}&z={z}"],tileSize:256}},layers:[{id:"amap-tiles",type:"raster",source:"raster-tiles",minzoom:0,maxzoom:24}]}}],y=r,p=()=>{const d=navigator.language||navigator.userLanguage,c=navigator.language.split("-")[0];let f="mul";c=="zh"&&i[d]&&(f=i[d]),c!=="zh"&&i[c]&&(f=i[c]),F.setRTLTextPlugin("https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js");const k=new $e({defaultLanguage:f});e.value.language=f,e.value.setStyle(k.setLanguage(e.value.getStyle(),f)),e.value.addControl(k)},x=d=>{const c=d.target.value,f=C.find(k=>k.id===c).url;e.value&&(e.value.setStyle(f),e.value.once("style.load",()=>{y.geodata.status=="GeoJSONLayers"&&D(y.geodata.data),y.geodata.status=="HeatMap"&&v(y.geodata.data)}))},I=d=>{const c=["match",["get","id"]];return Object.entries(d).length>0&&Object.entries(d).forEach(([k,L])=>{c.push(k,L)}),c.push("#B42222"),c},v=d=>{Object.keys(d).length!=0&&(e.value.getSource("findmy-data")||e.value.addSource("findmy-data",{type:"geojson",data:d}),e.value.getLayer("findmy-heatmap")||e.value.addLayer({id:"findmy-heatmap",type:"heatmap",source:"findmy-data",maxzoom:17,paint:{"heatmap-intensity":["interpolate",["linear"],["zoom"],0,1,9,3,15,10],"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(33,102,172,0)",.2,"rgb(103,169,207)",.4,"rgb(209,229,240)",.6,"rgb(253,219,199)",.8,"rgb(239,138,98)",1,"rgb(178,24,43)"],"heatmap-radius":["interpolate",["linear"],["zoom"],0,2,9,15],"heatmap-opacity":["interpolate",["linear"],["zoom"],0,.6,10,.7,17,1]},filter:["==","$type","Point"]}))},D=d=>{if(Object.keys(d).length==0)return;const c={},f={};Object.entries(y.itemsPropMap.value).forEach(b=>{const[H,E]=b;c[H]=E.pointColor,f[H]=E.lineColor});const k=I(c),L=I(f);e.value.getSource("findmy-data")||e.value.addSource("findmy-data",{type:"geojson",data:d}),e.value.getLayer("findmy-point")||e.value.addLayer({id:"findmy-point",type:"circle",source:"findmy-data",paint:{"circle-radius":6,"circle-color":k},filter:["==","$type","Point"]}),e.value.getLayer("findmy-route")||e.value.addLayer({id:"findmy-route",type:"line",source:"findmy-data",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":L,"line-width":3,"line-dasharray":[1,2]},filter:["==","$type","LineString"]}),e.value.getLayer("line-arrows")||e.value.addLayer({id:"line-arrows",type:"symbol",source:"findmy-data",layout:{"symbol-placement":"line","text-field":"‚ñ∂","text-size":24,"symbol-spacing":50,"text-keep-upright":!1},paint:{"text-color":"red"},filter:["==","$type","LineString"]})},S=(d,c)=>{d.forEach(f=>{e.value.getLayer(f)&&e.value.removeLayer(f)}),c.forEach(f=>{e.value.getSource(f)&&e.value.removeSource(f)})},V=d=>{const c=new F.LngLatBounds;d.features.forEach(function(f){const k=f.geometry.coordinates;c.extend(k)}),e.value.fitBounds(c,{padding:20})},M=d=>{const c=["in",["get","name"],["literal",d]];e.value.setFilter("findmy-point",c),e.value.setFilter("findmy-route",c),e.value.setFilter("line-arrows",c),a=!0},J=()=>{e.value.setFilter("findmy-point",null),e.value.setFilter("findmy-route",null),e.value.setFilter("line-arrows",null),a=!1},A=d=>{for(const c of d.features){const f=c.properties.id,k=document.createElement("div");k.className="marker";const L=document.createElement("div");if(L.className="markerWrapper",L.innerHTML='<div class="emoji-wrapper">üåè</div>',y.itemsPropMap.value[f].emoji){const le=y.itemsPropMap.value[f].emoji;L.innerHTML=`<div class="emoji-wrapper">${le}</div>`}k.appendChild(L);const b=c.properties.name,H=c.geometry.coordinates,E=H.join(","),z=c.properties.TimeStamp,oe=new F.Popup({offset:25}).setHTML(`<strong>Name:</strong> ${b}<br/><strong>Coordinates:</strong> ${E}<br/><strong>Timestamp:</strong> ${z}`),ae=new F.Marker(k).setLngLat(H).setPopup(oe).addTo(e.value);_.push(ae)}},j=()=>{if(_.length>0)for(const d of _)d.remove()},h=new F.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0});return n({map:e,switchStyle:x,setStyleLanguage:p,geometryColorSet:I,addHeatmapLayer:v,addGeoJSONLayers:D,removeGeoJSONLayers:S,setMapFilter:M,removeMapFilter:J,FitBounds:V,addRealtimeMarker:A,removeMarkers:j}),W(()=>{const d=[104.0657,30.6594];F.accessToken=m,e.value=new F.Map({container:u.value,style:C.find(c=>c.id===ge).url,center:d,zoom:2}),e.value.on("load",()=>{p()}),e.value.on("mouseenter","findmy-point",c=>{e.value.getCanvas().style.cursor="pointer";const f=a?1:0,k=c.features[f].geometry.coordinates.slice(),L=k.map(z=>z.toFixed(4).toString()),b=c.features[f].properties.TimeStamp,H=c.features[f].properties.name,E=new F.Popup({offset:25}).setLngLat(k).setHTML(`<strong>Name:</strong> ${H}<br/><strong>Coordinates:</strong> ${L}<br/><strong>Timestamp:</strong> ${b}`).addTo(e.value);e.value.on("mouseleave","findmy-point",()=>{e.value.getCanvas().style.cursor="",E.remove()})}),e.value.on("click","findmy-point",c=>{const f=a?1:0,k=c.features[f].geometry.coordinates.slice(),L=k.map(E=>E.toFixed(4).toString()),b=c.features[f].properties.TimeStamp,H=c.features[f].properties.name;new F.Popup({offset:25}).setLngLat(k).setHTML(`<strong>Name:</strong> ${H}<br/><strong>Coordinates:</strong> ${L}<br/><strong>Timestamp:</strong> ${b}`).addTo(e.value)}),e.value.addControl(new F.NavigationControl),e.value.addControl(h)}),(d,c)=>{const f=g("el-row"),k=g("el-col");return $(),N("div",null,[l("div",{id:"map",ref_key:"mapContainer",ref:u},null,512),o(me,{ref_key:"DataHandlerRef",ref:t},null,512),l("div",ot,[o(k,null,{default:s(()=>[($(),N(q,null,ce(C,L=>o(f,{span:6,key:L.id},{default:s(()=>[l("div",at,[l("input",{id:L.id,type:"radio",name:"rtoggle",value:L.id,checked:L.id===ge,onChange:x},null,40,lt),l("label",{for:L.id},O(L.label),9,st)])]),_:2},1024)),64))]),_:1})])])}}},rt=R(nt,[["__scopeId","data-v-c5704c4a"]]),fe=r=>(ue("data-v-1aee86ef"),r=r(),pe(),r),it={class:"flex-row-center"},dt={class:"flex-row"},ct=fe(()=>l("div",{class:"margin-right"},"iconColor:",-1)),ut={class:"flex-row"},pt=fe(()=>l("div",{class:"margin-right"},"pointColor:",-1)),mt={class:"flex-row"},ft=fe(()=>l("div",{class:"margin-right"},"lineColor:",-1)),vt={__name:"ColorPicker",props:{PropsMap:Object,selectedDevice:Object},setup(r){const n=r,u=se({get(){return n.selectedDevice.prop.bgColor},set(i){n.selectedDevice.prop.bgColor=i}}),e=se({get(){return n.selectedDevice.prop.pointColor},set(i){n.selectedDevice.prop.pointColor=i}}),t=se({get(){return n.selectedDevice.prop.lineColor},set(i){n.selectedDevice.prop.lineColor=i}}),a=w(["#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","rgb(255, 120, 0)","#c7158577"]);return(i,_)=>{const m=g("el-color-picker"),C=g("el-col"),y=g("el-row");return $(),N("div",it,[o(y,{gutter:10},{default:s(()=>[o(C,{xs:24,sm:24,md:8,lg:8},{default:s(()=>[l("div",dt,[ct,o(m,{modelValue:u.value,"onUpdate:modelValue":_[0]||(_[0]=p=>u.value=p),predefine:a.value},null,8,["modelValue","predefine"])])]),_:1}),o(C,{xs:24,sm:24,md:8,lg:8},{default:s(()=>[l("div",ut,[pt,o(m,{modelValue:e.value,"onUpdate:modelValue":_[1]||(_[1]=p=>e.value=p),predefine:a.value},null,8,["modelValue","predefine"])])]),_:1}),o(C,{xs:24,sm:24,md:8,lg:8},{default:s(()=>[l("div",mt,[ft,o(m,{modelValue:t.value,"onUpdate:modelValue":_[2]||(_[2]=p=>t.value=p),predefine:a.value},null,8,["modelValue","predefine"])])]),_:1})]),_:1})])}}},gt=R(vt,[["__scopeId","data-v-1aee86ef"]]),_t={key:0,class:"flex-column"},yt={class:"justify-center"},ht={class:"Emoji-2x"},bt={class:"Edit-info-div"},wt={class:"Edit-info-div-inner"},xt={class:"info-item flex-prop"},Dt={key:0,class:"single-line-text"},kt={class:"info-item flex-prop"},Ct={key:0,class:"single-line-text"},St={class:"info-item flex-prop"},$t={key:0,class:"single-line-text"},Lt={class:"info-item flex-prop"},Vt={key:0,class:"single-line-text"},Mt={__name:"EditDeviceDialog",props:xe({dialogEditVisible:Boolean,selectedDevice:Object,iconBgColor:Function,onSelectEmoji:Function},{modelValue:{prop:"modelValue",event:"update:modelValue"},modelModifiers:{}}),emits:["update:modelValue"],setup(r){const n=r,u=de(r,"modelValue"),e=w(!1),t=w(!1),a=w(!1),i=w(!1),_=w(!1),m=y=>{if(!_.value)switch(_.value=!0,setTimeout(()=>{_.value=!1},100),y){case"Name":e.value=!e.value;break;case"pubKey":t.value=!t.value;break;case"Location":a.value=!a.value;break;case"Lastupdate":i.value=!i.value;break}},C=y=>{m(y)};return(y,p)=>{const x=g("el-button"),I=g("el-popover"),v=g("el-col"),D=g("el-input"),S=g("el-row"),V=g("el-dialog");return $(),B(V,{modelValue:u.value,"onUpdate:modelValue":p[9]||(p[9]=M=>u.value=M),title:"Edit Device",draggable:"",width:"50%",class:"responsive-dialog"},{default:s(()=>[r.selectedDevice?($(),N("div",_t,[o(S,{gutter:10},{default:s(()=>[o(v,{xs:24,sm:24,md:6,lg:4},{default:s(()=>[l("div",yt,[o(I,{placement:"top",title:"Icon Picker",width:300,trigger:"click"},{reference:s(()=>[o(x,{class:"icon-div-2x",style:_e(r.iconBgColor(r.selectedDevice.prop.bgColor))},{default:s(()=>[l("div",ht,O(r.selectedDevice.prop.emoji),1)]),_:1},8,["style"])]),default:s(()=>[o(Z(ye),{native:!0,onSelect:p[0]||(p[0]=M=>r.onSelectEmoji(M,r.selectedDevice.id))})]),_:1})])]),_:1}),o(v,{xs:24,sm:24,md:18,lg:20},{default:s(()=>[l("div",bt,[l("div",wt,[l("div",xt,[T(" Name: "),e.value?($(),B(D,{key:1,modelValue:r.selectedDevice.prop.Name,"onUpdate:modelValue":p[1]||(p[1]=M=>r.selectedDevice.prop.Name=M),onBlur:p[2]||(p[2]=M=>C("Name")),onKeyup:p[3]||(p[3]=ie(M=>C("Name"),["enter"]))},null,8,["modelValue"])):($(),N("span",Dt,O(r.selectedDevice.prop.Name),1)),l("i",{onClick:p[4]||(p[4]=M=>m("Name")),class:"fas fa-edit edit-icon"})]),l("div",kt,[T(" pubKey: "),t.value?($(),B(D,{key:1,modelValue:r.selectedDevice.prop.pubKey,"onUpdate:modelValue":p[5]||(p[5]=M=>r.selectedDevice.prop.pubKey=M),onBlur:p[6]||(p[6]=M=>C("pubKey")),onKeyup:p[7]||(p[7]=ie(M=>C("pubKey"),["enter"]))},null,8,["modelValue"])):($(),N("span",Ct,O(r.selectedDevice.prop.pubKey),1)),l("i",{onClick:p[8]||(p[8]=M=>m("pubKey")),class:"fas fa-edit edit-icon"})]),l("div",St,[T(" Location: "),a.value?Y("",!0):($(),N("span",$t,O(r.selectedDevice.prop.Location),1))]),l("div",Lt,[T(" Lastupdate: "),i.value?Y("",!0):($(),N("span",Vt,O(r.selectedDevice.prop.Lastupdate),1))])])])]),_:1})]),_:1}),o(gt,De(y.$attrs,{selectedDevice:n.selectedDevice}),null,16,["selectedDevice"])])):Y("",!0)]),_:1},8,["modelValue"])}}},jt=R(Mt,[["__scopeId","data-v-50657422"]]),U=r=>(ue("data-v-d622276d"),r=r(),pe(),r),Pt={class:"manageForm"},It=U(()=>l("span",{class:"hide-small",style:{"vertical-align":"middle"}}," Add ",-1)),Nt={class:"justify-end"},Tt=U(()=>l("i",{class:"fa-solid fa-trash margin-right"},null,-1)),Ht=U(()=>l("span",{class:"hide-small",style:{"vertical-align":"middle"}}," Clear All",-1)),Ot=U(()=>l("i",{class:"fa-solid fa-rotate-right margin-right"},null,-1)),Et=U(()=>l("span",{class:"hide-small",style:{"vertical-align":"middle"}}," Refresh ",-1)),Ft={class:"scrolldiv"},zt={class:"itemsdiv"},Rt={class:"card-inner"},Ut={class:"Emoji"},At={class:"item-prop"},Kt={class:"flex-prop"},Bt={class:"flex-wrap"},Jt={key:0},Gt=U(()=>l("i",{class:"fa-solid fa-copy"},null,-1)),qt={class:"flex-prop"},Wt={class:"flex-wrap"},Yt={key:0},Zt=U(()=>l("i",{class:"fa-solid fa-copy"},null,-1)),Qt={class:"single-line-text"},Xt={class:"single-line-text"},eo={class:"main-layout-wrapper"},to=U(()=>l("i",{class:"fa-solid fa-box-archive",style:{"margin-right":"10px"}},null,-1)),oo={__name:"itemsManage",props:{propsMap:{type:Object,default:{}}},emits:["updateItemProps","reqUpdateItemProps"],setup(r,{emit:n}){const u=w(!1),e=w(!1),t=w(""),a=w(new Set),i=w(null),_=w(null),m=n,C=h=>h?`background-color:${h}`:"",y=w("350px"),p=()=>{const h=window.innerWidth,d=window.innerHeight;y.value=d*.5+"px",h<=768&&(y.value=d*.6+"px")};W(()=>{p(),window.addEventListener("resize",p),A()}),ke(()=>{window.removeEventListener("resize",p)});const x=h=>{_.value={id:h,prop:j[h]},e.value=!0},I=h=>{i.value=h},v=h=>{h in j&&delete j[h]},D=(h,d)=>{j[d].emoji=h.i,j[d].emojiName=h.n[0],j[d].emojiValue=h.u},S=()=>{const h=t.value;if(h&&!a.value.has(h)){a.value.add(h);const d=h;j[d]={emoji:"üåè",emojiName:"",emojiValue:"",bgColor:"#FFFFFF",pointColor:"red",lineColor:"blue",Name:h,serialNum:"N/A",pubKey:d,Lastupdate:"N/A",Added:new Date().toISOString(),Coordinate:["N/A","N/A"],Location:"N/A"},m("updateItemProps",j),t.value=""}},V=()=>{m("reqUpdateItemProps",j)},M=()=>{Object.keys(j).forEach(h=>{delete j[h]})},J=h=>{navigator.clipboard.writeText(h).then(()=>{console.log("Copied to clipboard successfully!")},d=>{console.error("Could not copy text: ",d)})},A=()=>{if(localStorage.getItem("itemsProp")){const h=localStorage.getItem("itemsProp"),d=JSON.parse(h);Object.assign(j,d.value),m("updateItemProps",j)}};let j=ee({});return(h,d)=>{const c=g("el-input"),f=g("el-col"),k=g("CirclePlus"),L=g("el-icon"),b=g("el-button"),H=g("el-popconfirm"),E=g("el-row"),z=g("el-popover"),oe=g("el-card"),ae=g("el-scrollbar"),le=g("el-dialog");return $(),N(q,null,[o(le,{modelValue:u.value,"onUpdate:modelValue":d[1]||(d[1]=P=>u.value=P),title:"Items Manage",draggable:"",class:"itemsManageDial",width:"95%"},{default:s(()=>[l("div",Pt,[o(E,{gutter:20},{default:s(()=>[o(f,{xs:12,sm:8},{default:s(()=>[o(c,{modelValue:t.value,"onUpdate:modelValue":d[0]||(d[0]=P=>t.value=P),onKeydown:ie(S,["enter"])},null,8,["modelValue"])]),_:1}),o(f,{xs:4,sm:4},{default:s(()=>[o(b,{type:"primary",onClick:S},{default:s(()=>[o(L,{style:{"vertical-align":"middle"}},{default:s(()=>[o(k)]),_:1}),It]),_:1})]),_:1}),o(f,{xs:4,sm:8}),o(f,{xs:4,sm:4},{default:s(()=>[l("div",Nt,[o(H,{"confirm-button-text":"Yes","cancel-button-text":"No","icon-color":"red",title:"Are you sure to delete All items?",onConfirm:M},{reference:s(()=>[o(b,{class:"clear-button",type:"danger"},{default:s(()=>[Tt,Ht]),_:1})]),_:1}),o(b,{class:"refresh-button",type:"primary",onClick:V},{default:s(()=>[Ot,Et]),_:1})])]),_:1})]),_:1})]),o(ae,{"max-height":y.value},{default:s(()=>[l("div",Ft,[l("div",zt,[o(E,{gutter:10},{default:s(()=>[($(!0),N(q,null,ce(Z(j),(P,G)=>($(),B(f,{key:G,xs:24,sm:12,md:8,lg:6},{default:s(()=>[o(z,{ref_for:!0,ref:"popover",placement:"top",title:"Options",width:200,trigger:"contextmenu"},{reference:s(()=>[o(oe,{class:"card",shadow:"hover",onClick:K=>x(G)},{default:s(()=>[l("div",Rt,[o(z,{placement:"right",title:"Icon Picker",width:300,trigger:"click"},{reference:s(()=>[o(b,{class:"icon-div",onClick:ne(K=>I(G),["stop"]),style:_e(C(P.bgColor))},{default:s(()=>[l("div",Ut,O(P.emoji),1)]),_:2},1032,["onClick","style"])]),default:s(()=>[o(Z(ye),{native:!0,onSelect:K=>D(K,G)},null,8,["onSelect"])]),_:2},1024),l("div",At,[l("div",Kt,[T("Name: "),o(z,{trigger:"hover",placement:"top"},{reference:s(()=>[l("div",Bt,[T(O(P.Name.substring(0,13))+" ",1),P.Name.length>10?($(),N("div",Jt,"... ")):Y("",!0),o(b,{link:"",onClick:ne(K=>J(P.Name),["stop"])},{default:s(()=>[Gt]),_:2},1032,["onClick"])])]),default:s(()=>[l("div",null,O(P.Name),1)]),_:2},1024)]),l("div",qt,[T("pubKey: "),o(z,{trigger:"hover",placement:"top"},{reference:s(()=>[l("div",Wt,[T(O(P.pubKey.substring(0,13))+" ",1),P.pubKey.length>10?($(),N("div",Yt,"... ")):Y("",!0),o(b,{link:"",onClick:ne(K=>J(P.pubKey),["stop"])},{default:s(()=>[Zt]),_:2},1032,["onClick"])])]),default:s(()=>[l("div",null,O(P.pubKey),1)]),_:2},1024)]),l("div",Qt,"Location: "+O(P.Location),1),l("div",Xt,"LastUpdate: "+O(P.Lastupdate),1)])])]),_:2},1032,["onClick"])]),default:s(()=>[l("div",null,[o(b,{onClick:K=>x(G)},{default:s(()=>[T("Edit")]),_:2},1032,["onClick"]),o(b,{type:"danger",onClick:K=>v(G)},{default:s(()=>[T("Delete")]),_:2},1032,["onClick"])])]),_:2},1536)]),_:2},1024))),128))]),_:1})])])]),_:1},8,["max-height"])]),_:1},8,["modelValue"]),o(jt,{modelValue:e.value,"onUpdate:modelValue":d[2]||(d[2]=P=>e.value=P),selectedDevice:_.value,iconBgColor:C,onSelectEmoji:D,PropsMap:Z(j)},null,8,["modelValue","selectedDevice","PropsMap"]),l("div",eo,[o(b,{class:"dail-button",type:"primary",onClick:d[3]||(d[3]=P=>u.value=!0)},{default:s(()=>[to,T("Items ")]),_:1})])],64)}}},ao=R(oo,[["__scopeId","data-v-d622276d"]]),be={__name:"MainApp",setup(r){const n=w(null),u=w(null),e=w({}),t=ee({}),a={layers:["findmy-point","findmy-route","line-arrows","findmy-heatmap"],sources:["findmy-data"]},i=v=>{e.value.data=v,e.value.status="GeoJSONLayers",n.value.removeGeoJSONLayers(a.layers,a.sources),n.value.addGeoJSONLayers(v),n.value.FitBounds(v)},_=v=>{n.value.map.getStyle().layers[0].id=="amap-tiles"&&re.transform(v,re.WGS84,re.GCJ02)},m=v=>{e.value.data=v,e.value.status="HeatMap",n.value.removeGeoJSONLayers(a.layers,a.sources),n.value.addHeatmapLayer(v),n.value.FitBounds(v)},C=async v=>{v.mode="timerange",await u.value.fetchData(v);const D=u.value.exposedData;_(D),i(D)},y=async v=>{v.mode="timerange",await u.value.fetchData(v);const D=u.value.exposedData;_(D),m(D)},p=async v=>{const D={...v};D.dateTimeRange=[],D.mode="realtime",await u.value.fetchData(D);const S=u.value.exposedData;_(S),n.value.removeMarkers(),n.value.addRealtimeMarker(S),n.value.FitBounds(S)},x=v=>{t.value=v},I=async v=>{const D=ee({idSelected:[],dateTimeRange:[],mode:"realtime"});Object.values(v).forEach(V=>{D.idSelected.push(V.pubKey)}),(await u.value.fetchData(D)).data.forEach(V=>{v[V.id].Lastupdate=V.isodatetime,v[V.id].Coordinate=[V.longitude,V.latitude]})};return W(()=>{}),(v,D)=>($(),N(q,null,[o(tt,{"items-props":t,onSubmit:C,onAddHeatMap:y,onRealtime:p},null,8,["items-props"]),o(ao,{onUpdateItemProps:x,onReqUpdateItemProps:I}),o(rt,{geodata:e.value,itemsPropMap:t,ref_key:"MapboxMainRef",ref:n},null,8,["geodata","itemsPropMap"]),o(me,{ref_key:"DataHandlerRef",ref:u},null,512),o(he,{data:t},null,8,["data"])],64))}},lo={__name:"App",setup(r){return(n,u)=>($(),B(be))}};Le({history:Ve("/FindMyTrackPage/"),routes:[{path:"/",name:"home",component:be}]});Ie.add(Ne);const te=Ce(lo);te.component("font-awesome-icon",Te);for(const[r,n]of Object.entries(Pe))te.component(r,n);te.use(Me,{locale:je});te.mount("#app");
